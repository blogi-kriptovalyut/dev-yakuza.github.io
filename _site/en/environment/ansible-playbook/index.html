<!DOCTYPE html>

<html lang="en">

  <head>
  
  <meta charset="utf-8" />
  
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  <meta name="twitter:title" content="Ansible Playbook" />
  <meta name="twitter:description" content="let's try to use Ansible Playbook to install server programs and to configure the server." />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@DevYakuza" />
  <meta name="twitter:creator" content="@DevYakuza" />

  <title>Ansible Playbook - let's try to use Ansible Playbook to install server programs and to configure the server.</title>
  <meta
    name="description"
    content="let&#39;s try to use Ansible Playbook to install server programs and to configure the server."
  />

  
  <meta
    property="og:url"
    content="http://localhost:4000/en/environment/ansible-playbook/"
  />
   <!-- Begin Jekyll SEO tag v2.5.0 -->
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Ansible Playbook" />
<meta name="author" content="dev.yakuza@gmail.com" />
<meta property="og:locale" content="en" />
<meta name="description" content="let’s try to use Ansible Playbook to install server programs and to configure the server." />
<meta property="og:description" content="let’s try to use Ansible Playbook to install server programs and to configure the server." />
<link rel="canonical" href="http://localhost:4000/en/environment/ansible-playbook/" />
<meta property="og:url" content="http://localhost:4000/environment/ansible-playbook/" />
<meta property="og:site_name" content="Dreams the art through programming" />
<meta property="og:image" content="http://localhost:4000/assets/images/category/environment/ansible-playbook.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-12-02T00:00:00+09:00" />
<script type="application/ld+json">
{"description":"let’s try to use Ansible Playbook to install server programs and to configure the server.","author":{"@type":"Person","name":"dev.yakuza@gmail.com"},"@type":"BlogPosting","url":"http://localhost:4000/environment/ansible-playbook/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://dev-yakuza.github.io/assets/images/icon.png"},"name":"dev.yakuza@gmail.com"},"image":"http://localhost:4000/assets/images/category/environment/ansible-playbook.jpg","headline":"Ansible Playbook","dateModified":"2018-12-05T16:39:12+09:00","datePublished":"2018-12-02T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/environment/ansible-playbook/"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script
    async
    src="https://www.googletagmanager.com/gtag/js?id=UA-125408913-1"
  ></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-125408913-1');
  </script>

  <script
    async
    src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
  ></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: 'ca-pub-7987914246691031',
      enable_page_level_ads: true,
    });
  </script>

  
  <link
    href="https://fonts.googleapis.com/css?family=Noto+Sans"
    rel="stylesheet"
  />
  
  <link
    rel="stylesheet"
    href="/en/assets/vendor/bootstrap/css/bootstrap.min.css"
  />
  <link
    rel="stylesheet"
    href="/en/assets/vendor/font-awesome/css/font-awesome.min.css"
  />
  <link
    rel="stylesheet"
    href="/en/assets/main.css?v=20190307"
  />
  <link
    rel="alternate"
    type="application/rss+xml"
    title="Dreams the art through programming"
    href="/en/feed.xml"
  />

  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "dev.yakuza",
      "url": "http://localhost:4000",
      "sameAs": [
        "https://www.facebook.com/yakuza.dev.54",
        "https://www.instagram.com/dev_yakuza/",
        "https://twitter.com/DevYakuza"
      ]
    }
  </script>
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "http://localhost:4000",
      "logo": "https://dev-yakuza.github.io/assets/images/icon.png"
    }
  </script><script type="application/ld+json">
    {
      "@context":"http://schema.org",
      "@type":"ItemList",
      "itemListElement":[{
          "@type":"ListItem",
          "position":1,"url": "http://localhost:4000/en/environment/vagrant-install-and-usage/"},{
          "@type":"ListItem",
          "position":2,"url": "http://localhost:4000/en/environment/install-ansible/"},{
          "@type":"ListItem",
          "position":3,"url": "http://localhost:4000/en/environment/ansible-playbook/"},{
          "@type":"ListItem",
          "position":4,"url": "http://localhost:4000/en/environment/ansible-docker/"},{
          "@type":"ListItem",
          "position":5,"url": "http://localhost:4000/en/environment/ansible-laradock/"},{
          "@type":"ListItem",
          "position":6,"url": "http://localhost:4000/en/environment/ansible-laravel/"},{
          "@type":"ListItem",
          "position":7,"url": "http://localhost:4000/en/environment/ngrok/"}]
    }
  </script><link rel="stylesheet" href="/en/assets/highlight/railscasts.css" />
  <script src="/assets/highlight/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
</head>


  <body>

    <!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="/en/">
      <img src="/assets/images/icon.png" alt="dev.yakuza blog logo" />
      ヤクザ
    </a>
    <div class="navbar-menu-container">
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/en/">Home</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              Category
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              



<a class="dropdown-item" href="/en/environment/">dev environment</a>




<a class="dropdown-item" href="/en/kumoncho/">kumoncho</a>




<a class="dropdown-item" href="/en/git/">git</a>




<a class="dropdown-item" href="/en/jekyll/">jekyll blog</a>







<a class="dropdown-item" href="/en/blaboo/">BlaBoo</a>




<a class="dropdown-item" href="/en/laravel/">Laravel</a>




<a class="dropdown-item" href="/en/react-native/">react-native</a>











            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/en/contact/">Contact</a>
          </li>
        </ul>
      </div>

      <div class="btn-group-sm btn-translate-group dropdown">
        <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true"
          aria-expanded="false">
          <i class="fa fa-language" aria-hidden="true"></i>
        </button>
        <div class="dropdown-menu">
          <a class="dropdown-item menu-ko" href="/ko/environment/ansible-playbook/">한국어</a>
          <a class="dropdown-item menu-en" href="/en/environment/ansible-playbook/">English</a>
          <a class="dropdown-item menu-ja" href="/en/environment/ansible-playbook/">日本語</a>
        </div>
      </div>

      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive"
        aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fa fa-bars"></i>
      </button>
    </div>

    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="/en/">Home</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            Category
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            



<a class="dropdown-item" href="/en/environment/">dev environment</a>




<a class="dropdown-item" href="/en/kumoncho/">kumoncho</a>




<a class="dropdown-item" href="/en/git/">git</a>




<a class="dropdown-item" href="/en/jekyll/">jekyll blog</a>







<a class="dropdown-item" href="/en/blaboo/">BlaBoo</a>




<a class="dropdown-item" href="/en/laravel/">Laravel</a>




<a class="dropdown-item" href="/en/react-native/">react-native</a>











          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/en/contact/">Contact</a>
        </li>
      </ul>
    </div>

  </div>
</nav>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    var urlPath = window.location.pathname;
    if (urlPath.indexOf('/en/') >= 0) {
      $('.menu-ko').prop('href', urlPath.replace('/en/', '/ko/'));
      $('.menu-en').prop('href', urlPath);
      $('.menu-ja').prop('href', urlPath.replace('/en/', '/'));
    }
    else if (urlPath.indexOf('/ko/') >= 0) {
      $('.menu-ko').prop('href', urlPath);
      $('.menu-en').prop('href', urlPath.replace('/ko/', '/en/'));
      $('.menu-ja').prop('href', urlPath.replace('/ko/', '/'));
    }
    else {
      $('.menu-ko').prop('href', '/ko' + urlPath);
      $('.menu-en').prop('href', '/en' + urlPath);
      $('.menu-ja').prop('href', urlPath);
    }

    $('body').on('show.bs.dropdown', '.dropdown', function () {
      $(this).find('.dropdown-menu').first().stop(true, true).slideDown();
    });

    $('body').on('hide.bs.dropdown', '.dropdown', function () {
      $(this).find('.dropdown-menu').first().stop(true, true).slideUp();
    });
  });
</script>

    <!-- Page Header -->

<header
  class="masthead"
  style="background-image: url('/assets/images/category/environment/ansible-playbook.jpg')"
>
  
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <div class="post-heading">
            <h1>Ansible Playbook</h1>
            <div class="heading-date">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              2018-12-05
            </div>
            
            <h2 class="subheading">let's try to use Ansible Playbook to install server programs and to configure the server.</h2>
            
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        <nav aria-label="breadcrumb">
          <ol
            class="breadcrumb"
            itemscope
            itemtype="http://schema.org/BreadcrumbList"
          >
            <li
              class="breadcrumb-item"
              itemprop="itemListElement"
              itemscope
              itemtype="http://schema.org/ListItem"
            >
              <a
                itemtype="http://schema.org/Thing"
                itemprop="item"
                href="http://localhost:4000"
              >
                <span itemprop="name">Home</span>
              </a>
              <meta itemprop="position" content="1" />
            </li>
            <li
              class="breadcrumb-item"
              itemprop="itemListElement"
              itemscope
              itemtype="http://schema.org/ListItem"
            >
              <a
                itemtype="http://schema.org/Thing"
                itemprop="item"
                href="http://localhost:4000/en/environment"
              >
                <span itemprop="name">environment</span>
              </a>
              <meta itemprop="position" content="2" />
            </li>
            <li
              class="breadcrumb-item active"
              aria-current="page"
              itemprop="itemListElement"
              itemscope
              itemtype="http://schema.org/ListItem"
            >
              <a
                itemtype="http://schema.org/Thing"
                itemprop="item"
                href="http://localhost:4000/en/environment/ansible-playbook/"
              >
                <span itemprop="name">Ansible Playbook</span>
              </a>
              <meta itemprop="position" content="3" />
            </li>
          </ol>
        </nav>
      </div>
    </div>
    <div class="row">
      <article class="col-lg-8 col-md-10 mx-auto">
        <h2 id="outline">outline</h2>
<p>we try to use Ansilbe Playbook to configure the server. basically, we will use Ansible Playbook to install server programs we need and configure some settings. in this blog, we will make virtual machine(guest system) by vagrant and install Ansible in there.</p>

<ul>
  <li>if you want to know how to install vagrant, check previous blog post - <a href="http://localhost:4000/en/environment/vagrant-install-and-usage/" target="_blank">vagrant installation and usage</a>.</li>
  <li>if you don’t know how to install Ansible, see previous blog post - <a href="http://localhost:4000/en/environment/install-ansible/" target="_blank">Ansible installation</a>.</li>
</ul>

<p>this blog is based on the assumption that you have done two blogs above.</p>

<h2 id="create-ansible-playbook">create Ansible Playbook</h2>
<p>create <code class="highlighter-rouge">ansible</code> folder in <code class="highlighter-rouge">Vagrantfile</code> location.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>|-- ansible
|-- Vagrantfil
</code></pre></div></div>

<p>create <code class="highlighter-rouge">playbook.yml</code> file in <code class="highlighter-rouge">andible</code> folder. Ansible contents are based on <code class="highlighter-rouge">yml</code> file format and grammers. so if we can do <code class="highlighter-rouge">yml</code>, we could do in Ansible.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>|-- ansible
|    |-- playbook.yml
|-- Vagrantfil
</code></pre></div></div>

<p>the <code class="highlighter-rouge">playbook.yml</code> file is the start point of the Ansible. modify <code class="highlighter-rouge">playbook.yml</code> like below.</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="pi">-</span> <span class="na">hosts</span><span class="pi">:</span> <span class="s">localhost</span>
  <span class="na">roles</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">init</span>
</code></pre></div></div>

<p>we already talked at previous blog, Ansible is an automation tool for infrastructure. so we can manage local server and remote server infrastructure. we can set Ansible infrastructure target - local server or remote server - in <code class="highlighter-rouge">hosts</code>. in here, we try to make local development environment so we set <code class="highlighter-rouge">localhost</code> to <code class="highlighter-rouge">hosts</code>.</p>

<p>we can’t only make and define one Ansible Playbook file to manage all infrastructure features, but also manage it by separate files with <code class="highlighter-rouge">roles</code>. set folder list you managed separately under <code class="highlighter-rouge">roles</code>. in here, we only use one <code class="highlighter-rouge">init</code> folder, so added <code class="highlighter-rouge">-init</code> under <code class="highlighter-rouge">roles</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>|-- ansible
|    |-- init
|    |    |-- tasks
|    |    |    |-- main.yml
|    |-- playbook.yml
|-- Vagrantfil
</code></pre></div></div>

<p>create <code class="highlighter-rouge">init/tasks/main.yml</code> in <code class="highlighter-rouge">ansible</code> folder and modify it like below.</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Make app directory</span>
  <span class="na">file</span><span class="pi">:</span> <span class="s">path=/var/www state=directory mode=0755</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Symbolic link</span>
  <span class="na">file</span><span class="pi">:</span> <span class="s">src=/vagrant dest=/var/www/vhosts state=link</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set timezone to Asia/Tokyo</span>
  <span class="na">timezone</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Asia/Tokyo</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Update and upgrade apt packages</span>
  <span class="na">become</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">apt</span><span class="pi">:</span>
    <span class="na">upgrade</span><span class="pi">:</span> <span class="s">yes</span>
    <span class="na">update_cache</span><span class="pi">:</span> <span class="s">yes</span>
    <span class="na">cache_valid_time</span><span class="pi">:</span> <span class="s">86400</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Add python3.6 repo</span>
  <span class="na">apt_repository</span><span class="pi">:</span>
    <span class="na">repo</span><span class="pi">:</span> <span class="s1">'</span><span class="s">ppa:jonathonf/python-3.6'</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install basic packages</span>
  <span class="na">become</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">apt</span><span class="pi">:</span>
    <span class="na">pkg</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">git</span>
      <span class="pi">-</span> <span class="s">unzip</span>
      <span class="pi">-</span> <span class="s">python3.6</span>
      <span class="pi">-</span> <span class="s">python-pip</span>
      <span class="pi">-</span> <span class="s">python3-pip</span>
      <span class="pi">-</span> <span class="s">fabric</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
    <span class="na">update_cache</span><span class="pi">:</span> <span class="s">yes</span>
</code></pre></div></div>

<p>let’s see Ansible commands one by one.</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Make app directory</span>
  <span class="na">file</span><span class="pi">:</span> <span class="s">path=/var/www state=directory mode=0755</span>
</code></pre></div></div>

<p>above is one of Ansible commands. <code class="highlighter-rouge">name</code>
위에 내용은 앤서블(Ansible)의 명령어를 나타냅니다. <code class="highlighter-rouge">name</code> is the value to distinguish the current command. this command creates the folder by Ansible <code class="highlighter-rouge">file</code> command.</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Symbolic link</span>
  <span class="na">file</span><span class="pi">:</span> <span class="s">src=/vagrant dest=/var/www/vhosts state=link</span>
</code></pre></div></div>

<p>link <code class="highlighter-rouge">/vagrant</code> folder to <code class="highlighter-rouge">/var/www/vhosts</code> folder for management.</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set timezone to America/New_York</span>
  <span class="na">timezone</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">America/New_York</span>
</code></pre></div></div>

<p>set local server timezone.</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Update and upgrade apt packages</span>
  <span class="na">become</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">apt</span><span class="pi">:</span>
    <span class="na">upgrade</span><span class="pi">:</span> <span class="s">yes</span>
    <span class="na">update_cache</span><span class="pi">:</span> <span class="s">yes</span>
    <span class="na">cache_valid_time</span><span class="pi">:</span> <span class="s">86400</span>
  <span class="na">tags</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">packages</span>
</code></pre></div></div>

<p>update linux package management tool(<code class="highlighter-rouge">apt-get</code>). <code class="highlighter-rouge">become: true</code> executes Ansible command by root permission.</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Add python3.6 repo</span>
  <span class="na">apt_repository</span><span class="pi">:</span>
    <span class="na">repo</span><span class="pi">:</span> <span class="s1">'</span><span class="s">ppa:jonathonf/python-3.6'</span>
</code></pre></div></div>
<p>Ansible has some modules depend on python so we need to install python. add python repository for installing.</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install basic packages</span>
  <span class="na">become</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">apt</span><span class="pi">:</span>
    <span class="na">pkg</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">git</span>
        <span class="pi">-</span> <span class="s">unzip</span>
        <span class="pi">-</span> <span class="s">python3.6</span>
        <span class="pi">-</span> <span class="s">python-pip</span>
        <span class="pi">-</span> <span class="s">python3-pip</span>
        <span class="pi">-</span> <span class="s">fabric</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
    <span class="na">update_cache</span><span class="pi">:</span> <span class="s">yes</span>
</code></pre></div></div>

<p>install git, unzip programs and python programs for later.</p>

<h2 id="modify-vagrantfile">modify Vagrantfile</h2>
<p>add below to <code class="highlighter-rouge">Vagrantfile</code></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- mode: ruby -*-</span>
<span class="c1"># vi: set ft=ruby :</span>

<span class="no">Vagrant</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="s2">"2"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
 <span class="o">...</span>

  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">provision</span> <span class="s2">"shell"</span><span class="p">,</span> <span class="ss">inline: </span><span class="o">&lt;&lt;-</span><span class="no">SHELL</span><span class="sh">
    ...
    sudo ansible-playbook /vagrant/ansible/playbook.yml
</span><span class="no">  SHELL</span>

  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">synced_folder</span> <span class="s2">"."</span><span class="p">,</span> <span class="s2">"/vagrant"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>we added <code class="highlighter-rouge">ansible-playbook /vagrant/ansible/playbook.yml</code> in provision shell which we’ve introduced previous blog. if we execute <code class="highlighter-rouge">vagrant up</code> or <code class="highlighter-rouge">vagrant provision</code>, Ansible Playbook we created is automatically executed.</p>

<p>and we added <code class="highlighter-rouge">config.vm.synced_folder ".", "/vagrant"</code> command to sync local machine(host system) folder to virtual machine(guest system) <code class="highlighter-rouge">/vagrant</code> folder. now if we edit files in local machine(host system) folder, automatically upload and sync to virtual machine(guest system).</p>

<h2 id="test">test</h2>
<p>let’s test to configure the server automatically by Ansible Playbook and Vagrantfile. if old virtual machine(guest system) is executing, execute below vagrant command to destroy virtual machine(guest system).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vagrant destroy
</code></pre></div></div>

<p>execute below vagrant command to create virtual machine(guest system). we can see difference between before and now. we can see Ansible Playbook is executed in console.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vagrant up
</code></pre></div></div>

<p>after virtual machine(guest system) is created, execute below vagrant command to access to virtual machine(guest system).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vagrant ssh
</code></pre></div></div>

<p>execute below commands to check Vagrantfile and Ansible Playbook have worked well.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /vagrant
<span class="nb">ls

</span>git <span class="nt">--version</span>
unzip <span class="nt">-v</span>
</code></pre></div></div>

<h2 id="completed">completed</h2>
<p>in this blog post, we installed programs basically required by Ansible Playbook to virtual machine(guest system). we looked briefly Ansible Playbook through this blog. also we modified <code class="highlighter-rouge">Vagrantfile</code> to execute Ansible Playbook automatically when virtual machine(guest system) is started and sync the folder that Vagrantfile was executed to <code class="highlighter-rouge">/vagrant</code> folder in virtual machine(guest system).</p>

<p>we should use Ansible Playbook better than here, we feel shameful because of simple usage. we added Ansible Document site in the bottom. please see that and use Ansible more beautifully.</p>

<p>next we will see how to use docker in virtual machine(guest system).</p>

<h2 id="reference">reference</h2>
<ul>
  <li>Ansible Document: <a href="https://docs.ansible.com/" rel="nofollow noreferrer" target="_blank">https://docs.ansible.com/</a></li>
</ul>


        <div class="buy_me_a_coffee_container">
  <style>
    .bmc-button img {
      width: 27px !important;
      margin-bottom: 1px !important;
      box-shadow: none !important;
      border: none !important;
      vertical-align: middle !important;
    }
    .bmc-button {
      line-height: 36px !important;
      height: 37px !important;
      text-decoration: none !important;
      display: inline-flex !important;
      color: #ffffff !important;
      background-color: #ff813f !important;
      border-radius: 3px !important;
      border: 1px solid transparent !important;
      padding: 0px 9px !important;
      font-size: 17px !important;
      letter-spacing: -0.08px !important;
      box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;
      -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
      margin: 0 auto !important;
      font-family: 'Lato', sans-serif !important;
      -webkit-box-sizing: border-box !important;
      box-sizing: border-box !important;
      -o-transition: 0.3s all linear !important;
      -webkit-transition: 0.3s all linear !important;
      -moz-transition: 0.3s all linear !important;
      -ms-transition: 0.3s all linear !important;
      transition: 0.3s all linear !important;
    }
    .bmc-button:hover,
    .bmc-button:active,
    .bmc-button:focus {
      -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
      text-decoration: none !important;
      box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
      opacity: 0.85 !important;
      color: #ffffff !important;
    }</style
  ><link
    href="https://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext"
    rel="stylesheet"
  /><a
    class="bmc-button"
    target="_blank"
    href="https://www.buymeacoffee.com/j0cXhWiza"
    ><img
      src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg"
      alt="Buy me a coffee"
    /><span style="margin-left:5px">Buy me a coffee</span></a
  >
</div>

        <div class="post-list-container">
          <div class="header">
            <div class="header-title">Posts</div>
          </div>

          <div class="body">
            <div class="list-group"></div>
          </div>

          <div class="footer">
            <ul class="pagination">
              <li class="page-item page-item--previous">
                <div class="page-link" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                  <span class="sr-only">Previous</span>
                </div>
              </li>

              <li class="page-item page-item--next">
                <div class="page-link" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                  <span class="sr-only">Next</span>
                </div>
              </li>
            </ul>
          </div>
        </div>
        <script type="text/javascript">
          document.addEventListener('DOMContentLoaded', function() {
            var lang =
              'en' === 'ja'
                ? ''
                : '/en';

            $.get(lang + '/api/environment/posts.json', function(
              data,
              status
            ) {
              if (data.length > 0) {
                $('.post-list-container').show();

                data.forEach(function(post, index) {
                  var container = $('.post-list-container .body .list-group');
                  var page = container.find('.page-' + post.page);
                  debugger;
                  var active =
                    post.url.indexOf(location.pathname) >= 0 ? 'active' : '';

                  // post item in page
                  var item = '';
                  item +=
                    '<a href="' +
                    post.url +
                    '" class="list-group-item list-group-item-action flex-column align-items-start ' +
                    active +
                    '">';
                  item +=
                    '  <div class="d-flex w-100 justify-content-between">';
                  item += '    <div class="mb-1">' + post.title + '</div>';
                  item += '  </div>';
                  item +=
                    '  <div class="body-text">' + post.description + '</div>';
                  item += '</a>';

                  if (page.length > 0) {
                    // page already exists
                    page.addClass(active);
                    page.append(item);
                  } else {
                    // new page
                    var temp = '';
                    temp +=
                      '<div class="page page-' +
                      post.page +
                      ' ' +
                      active +
                      '">';
                    temp += item;
                    temp += '</div>';
                    container.append(temp);
                  }

                  // pagination
                  var paginationItem = '';
                  paginationItem +=
                    '<li class="page-item page-item--link ' +
                    active +
                    '" data-page="' +
                    post.page +
                    '">';
                  paginationItem +=
                    '  <div class="page-link" data-page="' + post.page + '">';
                  paginationItem += post.page;
                  paginationItem += '  </div>';
                  paginationItem += '</li>';

                  if (
                    $(
                      '.post-list-container .footer .page-item[data-page="' +
                        post.page +
                        '"]'
                    ).length === 0
                  ) {
                    $('.post-list-container .footer .page-item--next').before(
                      paginationItem
                    );
                  }

                  if (active === 'active') {
                    $('li[data-page=' + post.page + ']').addClass(active);
                  }

                  if (post.page > 1) {
                    $('.footer').css('display', 'flex');
                  }
                });
              }
            });

            $('body').on('click', '.page-link', function(e) {
              var pageContainer = $('.post-list-container .body .list-group');
              var paginationContainer = $('.footer .pagination');
              var currentItem = paginationContainer.find('.page-item.active');
              var currentPageNum = currentItem.find('.page-link').data('page');
              var pageNum = $(this).data('page');

              if (
                $(this)
                  .closest('.page-item')
                  .hasClass('page-item--previous')
              ) {
                if (currentPageNum > 1) {
                  pageNum = currentPageNum - 1;
                } else {
                  pageNum = 1;
                }
              } else if (
                $(this)
                  .closest('.page-item')
                  .hasClass('page-item--next')
              ) {
                var total = paginationContainer.find('.page-item--link').length;
                if (currentPageNum < total) {
                  pageNum = currentPageNum + 1;
                } else {
                  pageNum = total;
                }
              } else {
                var pageNum = $(this).data('page');
              }

              pageContainer.find('.page').removeClass('active');
              pageContainer.find('.page-' + pageNum).addClass('active');

              paginationContainer.find('.page-item').removeClass('active');
              paginationContainer
                .find('.page-link[data-page="' + pageNum + '"]')
                .closest('.page-item')
                .addClass('active');
            });
          });
        </script>
      </article>
      <div class="col-lg-8 col-md-10 mx-auto">
        <hr />
        
        <div id="disqus_thread"></div>
        <script>

          var disqus_config = function () {
            this.page.url = "http://localhost:4000/environment/ansible-playbook/";
            this.page.identifier = "http://localhost:4000/environment/ansible-playbook/";
          };
          (function () { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');

            
            s.src = 'https://https-dev-yakuza-github-io-en.disqus.com/embed.js';
            

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript
          >Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript"
            >comments powered by Disqus.</a
          ></noscript
        >
        
      </div>
    </div>
  </div>
</header>


    <!-- Footer -->

<hr>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto share-title">
        SHARE
      </div>
      <div class="col-lg-8 col-md-10 mx-auto">
        <ul class="list-inline text-center">
          <li class="list-inline-item">
            <a href="https://twitter.com/intent/tweet?text=Ansible Playbook&url=http://localhost:4000/environment/ansible-playbook/" rel="nofollow noreferrer"
              target="_blank">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>

          <li class="list-inline-item">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/environment/ansible-playbook/" rel="nofollow noreferrer"
              target="_blank">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>

          <li class="list-inline-item">
            <a href="http://localhost:4000/en/feed.xml" rel="nofollow noreferrer" target="_blank">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss-square fa-stack-1x fa-inverse" aria-hidden="true"></i>
              </span>
            </a>
          </li>

        </ul>
        <p class="copyright text-muted">Copyright &copy; dev.yakuza@gmail.com 2019</p>
      </div>
    </div>
  </div>
</footer>

    <script src="/assets/vendor/jquery/jquery.min.js"></script>
<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/assets/vendor/startbootstrap-clean-blog/js/clean-blog.min.js"></script>

<script src="/assets/scripts.js"></script>



  </body>

</html>
