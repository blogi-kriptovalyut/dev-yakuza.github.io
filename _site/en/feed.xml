<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom"><generator uri="https://jekyllrb.com/" version="3.7.3">Jekyll</generator><link href="https://dev-yakuza.github.io/en/feed.xml" rel="self" type="application/atom+xml"/><link href="https://dev-yakuza.github.io/en/" rel="alternate" type="text/html"/><updated>2018-12-11T13:32:25+09:00</updated><id>https://dev-yakuza.github.io/</id><title type="html">Dreams the art through programming</title><subtitle>『Programming Artist ヤクザ』</subtitle><author><name>dev.yakuza@gmail.com</name></author><entry xml:lang="en"><title type="html">Ansible&amp;amp;Laravel</title><link href="https://dev-yakuza.github.io/en/environment/ansible-laravel/" rel="alternate" type="text/html" title="Ansible&amp;Laravel"/><published>2018-12-06T00:00:00+09:00</published><updated>2018-12-11T13:20:38+09:00</updated><id>https://dev-yakuza.github.io/environment/ansible-laravel-en</id><content type="html" xml:base="https://dev-yakuza.github.io/environment/ansible-laravel/">&lt;h2 id=&quot;outline&quot;&gt;outline&lt;/h2&gt; &lt;p&gt;at previous blog, we installed Laradock by Ansible. to develop Laravel, we will install and create Laravel project.&lt;/p&gt; &lt;p&gt;this blog is the series of below list. we recommend to read below list for understanding.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/vagrant-install-and-usage/&quot; target=&quot;_blank&quot;&gt;vagrant installation and usage&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/install-ansible/&quot; target=&quot;_blank&quot;&gt;Ansible installation&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/ansible-playbook/&quot; target=&quot;_blank&quot;&gt;Ansible Playbook&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/ansible-docker/&quot; target=&quot;_blank&quot;&gt;Ansible&amp;amp;Docker&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/ansible-laradock/&quot; target=&quot;_blank&quot;&gt;Ansible&amp;amp;Laradock&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;h2 id=&quot;configure-php-and-composer&quot;&gt;configure php and composer&lt;/h2&gt; &lt;p&gt;if you installed php and composer in local machine(host system), it’s better to skip this section. to create Laravel project, we’ll install php and composer on virtual machine(guest system).&lt;/p&gt; &lt;p&gt;add php and composer installation &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; to Ansible Playbook folder we’ve made until now.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;|-- ansible | |-- init | | |-- tasks | | | |-- main.yml | |-- docker | | |-- tasks | | | |-- main.yml | |-- laradock | | |-- tasks | | | |-- main.yml | |-- php | | |-- tasks | | | |-- main.yml | |-- playbook.yml |-- Vagrantfile &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;add new php &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; to Ansible Playbook file.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;localhost&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;local&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;roles&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;laradock&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;modify Ansible Playbook &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; file &lt;code class=&quot;highlighter-rouge&quot;&gt;php/tasks/main.yml&lt;/code&gt; like below.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Add php7.2 repo&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apt_repository&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;ppa:ondrej/php'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install php&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apt&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;pkg&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php7.2&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php7.2-mbstring&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php7.2-xml&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;present&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;update_cache&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;yes&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;check composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;stat&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;path=/usr/local/bin/composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;composer_bin&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;download composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;get_url&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;https://getcomposer.org/installer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/tmp/installer&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;install composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cat /tmp/installer | php -- --install-dir=/usr/local/bin&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;rename composer.phar to composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;mv /usr/local/bin/composer.phar /usr/local/bin/composer&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;make composer executable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/usr/local/bin/composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;a+x&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;not composer_bin.stat.exists&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;stop apache2&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;update-rc.d apache2 disable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;let’s see &lt;code class=&quot;highlighter-rouge&quot;&gt;task&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; one by one.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Add php7.2 repo&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apt_repository&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;ppa:ondrej/php'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;to install php 7.2, add php 7.2 repository to &lt;code class=&quot;highlighter-rouge&quot;&gt;apt&lt;/code&gt;.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install php&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apt&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;pkg&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php7.2&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php7.2-mbstring&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php7.2-xml&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;present&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;update_cache&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;yes&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;install php 7.2 and php modules for installing and executing Laravel.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;check composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;stat&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;path=/usr/local/bin/composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;composer_bin&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;before installing composer, check composer file exists and store the result to &lt;code class=&quot;highlighter-rouge&quot;&gt;composer bin&lt;/code&gt; variable.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;not composer_bin.stat.exists&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;enclose multiple &lt;code class=&quot;highlighter-rouge&quot;&gt;task&lt;/code&gt; in a block. also, also, this block is run only when composer file does not exist by checking &lt;code class=&quot;highlighter-rouge&quot;&gt;composer_bin&lt;/code&gt;variable.&lt;/p&gt; &lt;p&gt;let’s see the block one by one.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;download composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;get_url&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;https://getcomposer.org/installer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/tmp/installer&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;download composer install script to &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp/installer&lt;/code&gt; file.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;install composer&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cat /tmp/installer | php -- --install-dir=/usr/local/bin&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;install composer to &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/bin&lt;/code&gt; folder by using composer install script.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;rename composer.phar to composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;mv /usr/local/bin/composer.phar /usr/local/bin/composer&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;change &lt;code class=&quot;highlighter-rouge&quot;&gt;composer.phar&lt;/code&gt; file name to &lt;code class=&quot;highlighter-rouge&quot;&gt;composer&lt;/code&gt;.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;make composer executable&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/usr/local/bin/composer&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;a+x&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;file&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;change the permission so that composer is executable.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;stop apache2&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;update-rc.d apache2 disable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;php&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;after installing php, we got a problem. when virtual machine(guest system) is restarted, &lt;code class=&quot;highlighter-rouge&quot;&gt;apache2&lt;/code&gt; is started and Docker that uses same port is not executed. so we configure not to start &lt;code class=&quot;highlighter-rouge&quot;&gt;apache2&lt;/code&gt; server when virtual machine(guest system) is restarted.&lt;/p&gt; &lt;h2 id=&quot;install-php-and-composer&quot;&gt;install php and composer&lt;/h2&gt; &lt;p&gt;execute Ansible Playbook &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; we made above to install php and composer. we added php tag to &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; for only executing specific &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt;. execute below command to run only &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; tagged php.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#vagrant ssh&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ansible-playbook /vagrant/ansible/playbook.yml &lt;span class=&quot;nt&quot;&gt;--tags&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'php'&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;execute below command to check php and composer are installed well.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#vagrant ssh&lt;/span&gt; php &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt; composer &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;create-laravel-project&quot;&gt;create Laravel project&lt;/h2&gt; &lt;p&gt;execute below command to create Laravel project. if you have your own Laravel project, you can skip below command.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#vagrant ssh&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /vagrant composer create-project laravel/laravel app &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;configure-laravel-project&quot;&gt;configure Laravel project&lt;/h2&gt; &lt;p&gt;at previous blog post(&lt;a href=&quot;https://dev-yakuza.github.io/environment/ansible-laradock/&quot; target=&quot;_blank&quot;&gt;Ansible&amp;amp;Laradock&lt;/a&gt;), we’ve made Laradock installation &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; like below.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;change project folder&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/vagrant/lib/laradock/.env&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;regexp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;APP_CODE_PATH_HOST=*.*'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;APP_CODE_PATH_HOST=/vagrant/app'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;replace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;...&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;we’ve set to sync &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant/app&lt;/code&gt; folder to Laradock workspace Docker when created. so we made new project on &lt;code class=&quot;highlighter-rouge&quot;&gt;/app&lt;/code&gt; folder in &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant&lt;/code&gt; folder. if you have existing Laravel project, you should copy to &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant/app&lt;/code&gt; or you sould modify above part in Laradock &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt;.&lt;/p&gt; &lt;h2 id=&quot;check-laravel-project&quot;&gt;check Laravel project&lt;/h2&gt; &lt;p&gt;now, access localhost again. you can see basic Laravel screen.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/environment/ansible-laravel/laravel.png&quot; alt=&quot;laravel first page&quot; /&gt;&lt;/p&gt; &lt;p&gt;if Laravel is not configured well, you can see 500 error screen like below.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/environment/ansible-laravel/laravel_error.png&quot; alt=&quot;laravel 500 error page&quot; /&gt;&lt;/p&gt; &lt;p&gt;check if missed settings exist during you configure Laravel. if you use &lt;code class=&quot;highlighter-rouge&quot;&gt;composer create-project laravel/laravel app&lt;/code&gt; command to create new Laravel project, below settings is automatically executed.&lt;/p&gt; &lt;p&gt;Did you install required Laravel project libraries?&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;composer install &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;Did you create Laravel environment file?&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cp .env.example .env &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;Did you configure Larevel key?&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;php artisan key:generate &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;phpmyadmin&quot;&gt;phpmyadmin&lt;/h2&gt; &lt;p&gt;let’s access &lt;code class=&quot;highlighter-rouge&quot;&gt;phpmyadmin&lt;/code&gt; to set Database. you can see &lt;code class=&quot;highlighter-rouge&quot;&gt;phpmyadmin&lt;/code&gt; screen when you access &lt;code class=&quot;highlighter-rouge&quot;&gt;localhost:8080&lt;/code&gt;&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/environment/ansible-laravel/phpmyadmin_login.png&quot; alt=&quot;phpmyadmin login&quot; /&gt;&lt;/p&gt; &lt;p&gt;if you didn’t configure anything, you can access by below informations.&lt;/p&gt; &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server: mysql username: root password: root &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;you can see below screen after login.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/environment/ansible-laravel/phpmyadmin_change_password.png&quot; alt=&quot;phpmyadmin change password&quot; /&gt;&lt;/p&gt; &lt;p&gt;click &lt;code class=&quot;highlighter-rouge&quot;&gt;Change password&lt;/code&gt; on the middle of the screen and change password.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/environment/ansible-laravel/phpmyadmin_new_password.png&quot; alt=&quot;phpmyadmin new password&quot; /&gt;&lt;/p&gt; &lt;p&gt;click &lt;code class=&quot;highlighter-rouge&quot;&gt;Database&lt;/code&gt; menu on the top of the screen and create database for Laravel.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/environment/ansible-laravel/phpmyadmin_new_database.png&quot; alt=&quot;phpmyadmin new database&quot; /&gt;&lt;/p&gt; &lt;h2 id=&quot;configure-laravel-db&quot;&gt;configure Laravel DB&lt;/h2&gt; &lt;p&gt;we need to connect Laravel project to Database we’ve made above using &lt;code class=&quot;highlighter-rouge&quot;&gt;phpmyadmin&lt;/code&gt;. you can see below when you open Laravel environment file &lt;code class=&quot;highlighter-rouge&quot;&gt;.env&lt;/code&gt;.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;... &lt;span class=&quot;nv&quot;&gt;DB_CONNECTION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql &lt;span class=&quot;nv&quot;&gt;DB_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;127.0.0.1 &lt;span class=&quot;nv&quot;&gt;DB_PORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3306 &lt;span class=&quot;nv&quot;&gt;DB_DATABASE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;homestead &lt;span class=&quot;nv&quot;&gt;DB_USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;homestead &lt;span class=&quot;nv&quot;&gt;DB_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;secret ... &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;modify this parts like below. insert what you’ve set up to settings &lt;code class=&quot;highlighter-rouge&quot;&gt;DB_DATABASE&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;DB_PASSWORD&lt;/code&gt;.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;... &lt;span class=&quot;nv&quot;&gt;DB_CONNECTION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql &lt;span class=&quot;nv&quot;&gt;DB_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql &lt;span class=&quot;nv&quot;&gt;DB_PORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3306 &lt;span class=&quot;nv&quot;&gt;DB_DATABASE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;app &lt;span class=&quot;nv&quot;&gt;DB_USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;root &lt;span class=&quot;nv&quot;&gt;DB_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt; ... &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;if you do so, try to create User Table that Laravel basically provides.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# vagrant ssh&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# sudo docker exec -it laradock_workspace_1 bash&lt;/span&gt; php artisan migrate &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;if you don’t use User Table that Laravel basically provides, remove it by Laravel command below.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;php artisan migrate:rollback &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;completed&quot;&gt;completed&lt;/h2&gt; &lt;p&gt;we’ve made Laravel development environment using vagrant, Ansible and Laradock. also, we’ve seen a little bit how to use Ansible and Docker through creating development environment. if we use Ansible and Docker very well, maybe we can be &lt;code class=&quot;highlighter-rouge&quot;&gt;DevOps&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;we will continue to add contents related to building development environment, Docker and Ansible to this &lt;a href=&quot;https://dev-yakuza.github.io/environment/&quot; target=&quot;_blank&quot;&gt;dev environment&lt;/a&gt; category. also, we will add contents about Laravel development to &lt;a href=&quot;https://dev-yakuza.github.io/laravel/&quot; target=&quot;_blank&quot;&gt;Laravel&lt;/a&gt;, so please see it.&lt;/p&gt; &lt;h2 id=&quot;reference&quot;&gt;reference&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;&lt;a href=&quot;https://laradock.io/documentation/&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://laradock.io/documentation/&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;</content><author><name>dev.yakuza@gmail.com</name></author><summary type="html">outline at previous blog, we installed Laradock by Ansible. to develop Laravel, we will install and create Laravel project.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://dev-yakuza.github.io/assets/images/category/environment/ansible-laravel.jpg"/></entry><entry xml:lang="en"><title type="html">Ansible&amp;amp;Laradock</title><link href="https://dev-yakuza.github.io/en/environment/ansible-laradock/" rel="alternate" type="text/html" title="Ansible&amp;Laradock"/><published>2018-12-05T00:00:00+09:00</published><updated>2018-12-10T17:38:20+09:00</updated><id>https://dev-yakuza.github.io/environment/ansible-laradock-en</id><content type="html" xml:base="https://dev-yakuza.github.io/environment/ansible-laradock/">&lt;h2 id=&quot;outline&quot;&gt;outline&lt;/h2&gt; &lt;p&gt;in these days, everything is existed in the world. something we thought is already existed and shared in somewhere. Laradock is the project that creates and manages Dockers for Laravel development environment. if you want to know more details, see official repository(&lt;a href=&quot;https://github.com/laradock/laradock/&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://github.com/laradock/laradock/&lt;/a&gt;). in here, we will introduce how to use Laradock to make Laravel development environment.&lt;/p&gt; &lt;p&gt;this blog is the series of below list. we recommend to read below list for understanding.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/vagrant-install-and-usage/&quot; target=&quot;_blank&quot;&gt;vagrant installation and usage&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/install-ansible/&quot; target=&quot;_blank&quot;&gt;Ansible installation&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/ansible-playbook/&quot; target=&quot;_blank&quot;&gt;Ansible Playbook&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/ansible-docker/&quot; target=&quot;_blank&quot;&gt;Ansible&amp;amp;Docker&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;h2 id=&quot;configure-development-environment&quot;&gt;configure development environment&lt;/h2&gt; &lt;p&gt;Laradock provides many Dockers for configuring development environment. so we should decide which Docker we will use for development. we’ve decided to use below list for configuring development environment.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;nginx&lt;/li&gt; &lt;li&gt;mysql&lt;/li&gt; &lt;li&gt;phpmyadmin&lt;/li&gt; &lt;li&gt;workspace&lt;/li&gt; &lt;/ul&gt; &lt;h2 id=&quot;modify-virtual-machine-setting&quot;&gt;modify virtual machine setting&lt;/h2&gt; &lt;p&gt;modify &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; for virtual machine setting.&lt;/p&gt; &lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# -*- mode: ruby -*-&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# vi: set ft=ruby :&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;provider&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:virtualbox&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;laravel-dev&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;network&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;forwarded_port&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;guest: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;host: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;network&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;forwarded_port&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;guest: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8080&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;host: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8080&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;after&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:up&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;trigger Docker after Vagrant Up&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;run_remote&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;inline: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sudo ansible-playbook /vagrant/ansible/playbook.yml --tags 'docker'&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;we set specific name(&lt;code class=&quot;highlighter-rouge&quot;&gt;laravel-dev&lt;/code&gt;) by &lt;code class=&quot;highlighter-rouge&quot;&gt;vb.name&lt;/code&gt; to display it on virtualbox. this part actually is not related with development environment, just display it for easy understanding.&lt;/p&gt; &lt;p&gt;we used &lt;code class=&quot;highlighter-rouge&quot;&gt;config.vm.network &quot;forwarded_port&quot;&lt;/code&gt; of vagrant features for port-forward betwenn local machine(host system) and virtual machine(guest system). now we can access virtual machine(guest system) ports by local machine(host system) ports. 80 port is for Laravel project and 8080 is for phpmyadmin to acceess.&lt;/p&gt; &lt;p&gt;we can stop virtual machine(guest system) by vagrant command(&lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant halt&lt;/code&gt;) and restart it by vagrant command(&lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant up&lt;/code&gt;). however, Ansible Playbook is not executed because it is in Provision shell when virutal machine(guest system) is restarted. and Laradock Dockers is not configured to restart always so when virtual machine(guest system) is restarted, Dockers are not executed. therefore, we modified Vagrantfile like below.&lt;/p&gt; &lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;after&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:up&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;trigger Docker after Vagrant Up&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;run_remote&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;inline: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sudo ansible-playbook /vagrant/ansible/playbook.yml --tags 'docker'&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;this option is executed after we execute &lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant up&lt;/code&gt; command to restart virtual machine(guest system). we configured Ansible Playbook will be executed after virtual machine(guest system) is restarted. Ansible Playbook command in here uses &lt;code class=&quot;highlighter-rouge&quot;&gt;--tags 'docker'&lt;/code&gt; unlike the command in provision shell. if we use this option, we can execute specific commands tagging &lt;code class=&quot;highlighter-rouge&quot;&gt;docker&lt;/code&gt;. we will explain more detail in below Ansible Playbook setting again.&lt;/p&gt; &lt;h2 id=&quot;set-laradock-in-ansible-playbook&quot;&gt;set Laradock in Ansible Playbook&lt;/h2&gt; &lt;p&gt;we’ll use previous Ansible Playbook setting for configure development environment. until now, folder structure is like below.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;|-- ansible | |-- init | | |-- tasks | | | |-- main.yml | |-- docker | | |-- tasks | | | |-- main.yml | |-- playbook.yml |-- Vagrantfile &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;we create &lt;code class=&quot;highlighter-rouge&quot;&gt;laradock/tasks/main.yml&lt;/code&gt; file to define &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; for Laradock.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;|-- ansible | |-- init | | |-- tasks | | | |-- main.yml | |-- docker | | |-- tasks | | | |-- main.yml | |-- laradock | | |-- tasks | | | |-- main.yml | |-- playbook.yml |-- Vagrantfile &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;add Laradock &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; to Ansible Playbook start point &lt;code class=&quot;highlighter-rouge&quot;&gt;playbook.yml&lt;/code&gt;.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;localhost&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;local&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;roles&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;laradock&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;modify &lt;code class=&quot;highlighter-rouge&quot;&gt;laradock/tasks/main.yml&lt;/code&gt; file we added like below.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;git clone Laradock&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;git&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;repo=https://github.com/Laradock/laradock.git dest=/vagrant/app/laradock/ version=master&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;copy Laradock environment file&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;src=/vagrant/app/laradock/env-example dest=/vagrant/app/laradock/.env&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;change mysql version&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/vagrant/app/laradock/.env&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;regexp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;MYSQL_VERSION=*.*'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;MYSQL_VERSION=5.7'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;replace&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;change project folder&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/vagrant/lib/laradock/.env&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;regexp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;APP_CODE_PATH_HOST=*.*'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;APP_CODE_PATH_HOST=/vagrant/app'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;replace&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;dokcer compose Laradock(nginx, mysql, phpmyadmin, workspace)&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;docker_service&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;present&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;project_src&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/vagrant/app/laradock&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;mysql&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;phpmyadmin&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;workspace&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;let’s see Ansible Playbook &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; we added.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;git clone Laradock&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;git&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;repo=https://github.com/Laradock/laradock.git dest=/vagrant/app/laradock/ version=master&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;this is to use Ansible git module to clone Laradock repository.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;copy Laradock environment file&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;src=/vagrant/app/laradock/env-example dest=/vagrant/app/laradock/.env&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;copy example environment file(&lt;code class=&quot;highlighter-rouge&quot;&gt;env-example&lt;/code&gt;) to environment file(&lt;code class=&quot;highlighter-rouge&quot;&gt;.env&lt;/code&gt;) we can use.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;change mysql version&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/vagrant/app/laradock/.env&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;regexp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;MYSQL_VERSION=*.*'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;MYSQL_VERSION=5.7'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;replace&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;change &lt;code class=&quot;highlighter-rouge&quot;&gt;mysql&lt;/code&gt; version to &lt;code class=&quot;highlighter-rouge&quot;&gt;5.7&lt;/code&gt; in Laradock environment file(&lt;code class=&quot;highlighter-rouge&quot;&gt;.env&lt;/code&gt;). when we used recent version(&lt;code class=&quot;highlighter-rouge&quot;&gt;8.0&lt;/code&gt;), we got below error message when we access mysql from Laravel.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;PDOException] SQLSTATE[HY000] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2054] The server requested authentication method unknown to the client &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;maybe, Laravel is not supported new password authentication method of recent mysql. there are many solutions for this problem, but if you don’t use specific features in mysql 8.0, we recommend just downgrade to 5.7.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;change project folder&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/vagrant/lib/laradock/.env&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;regexp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;APP_CODE_PATH_HOST=*.*'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;APP_CODE_PATH_HOST=/vagrant/app'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;replace&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;Laradock workspace Docker is the environment that Laravel project is executed. this Docker refers&lt;code class=&quot;highlighter-rouge&quot;&gt;APP_CODE_PATH_HOST&lt;/code&gt; folder to sync it so workspace Docker is built and executed with this folder. basic option is &lt;code class=&quot;highlighter-rouge&quot;&gt;APP_CODE_PATH_HOST=../&lt;/code&gt; which means upper Laradock folder. we modified this to &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant/app&lt;/code&gt;. you can modify it to your Laravel project folder or you can change your Laravel project folder name to &lt;code class=&quot;highlighter-rouge&quot;&gt;app&lt;/code&gt;.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;dokcer compose Laradock(nginx, mysql, phpmyadmin, workspace)&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;docker_service&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;debug&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;present&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;restarted&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;project_src&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/vagrant/app/laradock&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;mysql&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;phpmyadmin&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;workspace&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;build and execute required Dockers by Ansible Docker Service module. this task uses &lt;code class=&quot;highlighter-rouge&quot;&gt;tag&lt;/code&gt; feature unlike others. if we use &lt;code class=&quot;highlighter-rouge&quot;&gt;--tags&lt;/code&gt; option in executing Ansible Playbook command, we can execute only tagged commands in all commands. if &lt;code class=&quot;highlighter-rouge&quot;&gt;--tags&lt;/code&gt; option is not set, Ansible Playbook executes all commands.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# execute all commands&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ansible-playbook /vagrant/ansible/playbook.yml &lt;span class=&quot;c&quot;&gt;# execute commands tagged docker&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ansible-playbook /vagrant/ansible/playbook.yml &lt;span class=&quot;nt&quot;&gt;--tags&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'docker'&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;execute-ansible-playbook&quot;&gt;execute Ansible Playbook&lt;/h2&gt; &lt;p&gt;completed to configure Laradock &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; to Ansible Playbook. let’s execute Ansible Playbook to install Laradock.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# vagrant ssh&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ansible-playbook /vagrant/ansible/playbook.yml &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;check-laradock-is-installed&quot;&gt;check Laradock is installed&lt;/h2&gt; &lt;p&gt;execute below Docker command to check Laradock is installed well by Ansible Playbook.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# vagrant ssh&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;docker ps &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;also, open &lt;code class=&quot;highlighter-rouge&quot;&gt;http://localhost&lt;/code&gt; on local machine(host system) browser. you can see &lt;code class=&quot;highlighter-rouge&quot;&gt;nginx&lt;/code&gt;’s &lt;code class=&quot;highlighter-rouge&quot;&gt;404 Not Found&lt;/code&gt; error screen.&lt;/p&gt; &lt;h2 id=&quot;completed&quot;&gt;completed&lt;/h2&gt; &lt;p&gt;we prepared Laravel development environment by installing Laradock using Ansible. now we can see &lt;code class=&quot;highlighter-rouge&quot;&gt;404 Not Found&lt;/code&gt; because we’ve not set Laravel project but Laravel development environment was ready by Laradock. next, we will configure Laravel project on Laradock development environment.&lt;/p&gt; &lt;h2 id=&quot;reference&quot;&gt;reference&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;&lt;a href=&quot;https://laradock.io/documentation/&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://laradock.io/documentation/&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;</content><author><name>dev.yakuza@gmail.com</name></author><summary type="html">outline in these days, everything is existed in the world. something we thought is already existed and shared in somewhere. Laradock is the project that creates and manages Dockers for Laravel development environment. if you want to know more details, see official repository(https://github.com/laradock/laradock/). in here, we will introduce how to use Laradock to make Laravel development environment.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://dev-yakuza.github.io/assets/images/category/environment/ansible-laradock.jpg"/></entry><entry xml:lang="en"><title type="html">Ansible&amp;amp;Docker</title><link href="https://dev-yakuza.github.io/en/environment/ansible-docker/" rel="alternate" type="text/html" title="Ansible&amp;Docker"/><published>2018-12-04T00:00:00+09:00</published><updated>2018-12-05T16:39:12+09:00</updated><id>https://dev-yakuza.github.io/environment/ansible_docker-en</id><content type="html" xml:base="https://dev-yakuza.github.io/environment/ansible-docker/">&lt;h2 id=&quot;outline&quot;&gt;outline&lt;/h2&gt; &lt;p&gt;we can’t talk server development without Docker recently. in here, it’s difficult to explain all details about Docker. we will introduce Docker by explain it little by little when we need. we will explain how to install Docker and Docker Compose on vagrant by Ansible Playbook in this blog post.&lt;/p&gt; &lt;p&gt;this blog is based on the assumption that you have done three blogs below.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/vagrant-install-and-usage/&quot; target=&quot;_blank&quot;&gt;vagrant installation and usage&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/install-ansible/&quot; target=&quot;_blank&quot;&gt;Ansible installation&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://dev-yakuza.github.io/environment/ansible-playbook/&quot; target=&quot;_blank&quot;&gt;Ansible Playbook&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;h2 id=&quot;set-docker-in-ansible-playbook&quot;&gt;set Docker in Ansible Playbook&lt;/h2&gt; &lt;p&gt;below is the directory structure for vagrant virtual machine(guest system) we created until now.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;|-- ansible | |-- init | | |-- tasks | | | |-- main.yml | |-- playbook.yml |-- Vagrantfile &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;we’ll define &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; about Docker installation and add Ansible Playbook in here. create &lt;code class=&quot;highlighter-rouge&quot;&gt;docker/tasks/main.yml&lt;/code&gt; file in &lt;code class=&quot;highlighter-rouge&quot;&gt;ansible&lt;/code&gt; folder.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;|-- ansible | |-- init | | |-- tasks | | | |-- main.yml | |-- docker | | |-- tasks | | | |-- main.yml | |-- playbook.yml |-- Vagrantfile &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;modify &lt;code class=&quot;highlighter-rouge&quot;&gt;playbook.yml&lt;/code&gt; that is Ansible Playbook’s start point like below.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;localhost&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;local&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;roles&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;add below codes to &lt;code class=&quot;highlighter-rouge&quot;&gt;docker/tasks/main.yml&lt;/code&gt; we created.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install docker&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;curl https://get.docker.com | sh&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Modify privilege&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;usermod -aG docker $USER&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Change privilege of docker&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;dest=/usr/bin/docker mode=+x&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python docker / docker-compse module&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;pip&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker-compose&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;let’s see Ansible commands one by one.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install docker&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;curl https://get.docker.com | sh&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;this command is to install Docker by using Docker install script.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Modify privilege&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;usermod -aG docker $USER&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Change privilege of docker&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;chmod +x /usr/bin/docker&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;this is to change user and permission of Docker.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python docker / docker-compse module&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;pip&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker-compose&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;this command is to install python docker module and Docker Compose&lt;/p&gt; &lt;h2 id=&quot;execute-ansible&quot;&gt;execute Ansible&lt;/h2&gt; &lt;p&gt;execute below Ansible command in virtual machine(guest system) to execute Docker installation &lt;code class=&quot;highlighter-rouge&quot;&gt;role&lt;/code&gt; we added in Ansible Playbook above.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant ssh &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ansible-playbook /vagrant/ansible/playbook.yml &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;we executed Ansible Playbook because we already have virtual machine(guest system). if we make new environment, Ansible Playbook is automatically executed because we already added provision shell.&lt;/p&gt; &lt;p&gt;execute below vagrant command in local machine(host system) for testing.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant destroy vagrant up &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;check-docker-is-installed&quot;&gt;check Docker is installed&lt;/h2&gt; &lt;p&gt;execute below commands to check Docker is installed well on virtual machine(guest system) by Ansible Playbook.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant ssh docker &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt; docker-compose &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;completed&quot;&gt;completed&lt;/h2&gt; &lt;p&gt;we saw how to install Docker and Docker Compose by Ansible Playbook. now, we can make development environment via Docker. next blog post, we will introduce how to configure Laravel development environment by Docker and Docker Compose.&lt;/p&gt;</content><author><name>dev.yakuza@gmail.com</name></author><summary type="html">outline we can’t talk server development without Docker recently. in here, it’s difficult to explain all details about Docker. we will introduce Docker by explain it little by little when we need. we will explain how to install Docker and Docker Compose on vagrant by Ansible Playbook in this blog post.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://dev-yakuza.github.io/assets/images/category/environment/ansible-docker.jpg"/></entry><entry xml:lang="en"><title type="html">Ansible Playbook</title><link href="https://dev-yakuza.github.io/en/environment/ansible-playbook/" rel="alternate" type="text/html" title="Ansible Playbook"/><published>2018-12-02T00:00:00+09:00</published><updated>2018-12-05T16:39:12+09:00</updated><id>https://dev-yakuza.github.io/environment/ansible_playbook-en</id><content type="html" xml:base="https://dev-yakuza.github.io/environment/ansible-playbook/">&lt;h2 id=&quot;outline&quot;&gt;outline&lt;/h2&gt; &lt;p&gt;we try to use Ansilbe Playbook to configure the server. basically, we will use Ansible Playbook to install server programs we need and configure some settings. in this blog, we will make virtual machine(guest system) by vagrant and install Ansible in there.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;if you want to know how to install vagrant, check previous blog post - &lt;a href=&quot;https://dev-yakuza.github.io/environment/vagrant-install-and-usage/&quot; target=&quot;_blank&quot;&gt;vagrant installation and usage&lt;/a&gt;.&lt;/li&gt; &lt;li&gt;if you don’t know how to install Ansible, see previous blog post - &lt;a href=&quot;https://dev-yakuza.github.io/environment/install-ansible/&quot; target=&quot;_blank&quot;&gt;Ansible installation&lt;/a&gt;.&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;this blog is based on the assumption that you have done two blogs above.&lt;/p&gt; &lt;h2 id=&quot;create-ansible-playbook&quot;&gt;create Ansible Playbook&lt;/h2&gt; &lt;p&gt;create &lt;code class=&quot;highlighter-rouge&quot;&gt;ansible&lt;/code&gt; folder in &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; location.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;|-- ansible |-- Vagrantfil &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;create &lt;code class=&quot;highlighter-rouge&quot;&gt;playbook.yml&lt;/code&gt; file in &lt;code class=&quot;highlighter-rouge&quot;&gt;andible&lt;/code&gt; folder. Ansible contents are based on &lt;code class=&quot;highlighter-rouge&quot;&gt;yml&lt;/code&gt; file format and grammers. so if we can do &lt;code class=&quot;highlighter-rouge&quot;&gt;yml&lt;/code&gt;, we could do in Ansible.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;|-- ansible | |-- playbook.yml |-- Vagrantfil &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;the &lt;code class=&quot;highlighter-rouge&quot;&gt;playbook.yml&lt;/code&gt; file is the start point of the Ansible. modify &lt;code class=&quot;highlighter-rouge&quot;&gt;playbook.yml&lt;/code&gt; like below.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;localhost&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;roles&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;init&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;we already talked at previous blog, Ansible is an automation tool for infrastructure. so we can manage local server and remote server infrastructure. we can set Ansible infrastructure target - local server or remote server - in &lt;code class=&quot;highlighter-rouge&quot;&gt;hosts&lt;/code&gt;. in here, we try to make local development environment so we set &lt;code class=&quot;highlighter-rouge&quot;&gt;localhost&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;hosts&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;we can’t only make and define one Ansible Playbook file to manage all infrastructure features, but also manage it by separate files with &lt;code class=&quot;highlighter-rouge&quot;&gt;roles&lt;/code&gt;. set folder list you managed separately under &lt;code class=&quot;highlighter-rouge&quot;&gt;roles&lt;/code&gt;. in here, we only use one &lt;code class=&quot;highlighter-rouge&quot;&gt;init&lt;/code&gt; folder, so added &lt;code class=&quot;highlighter-rouge&quot;&gt;-init&lt;/code&gt; under &lt;code class=&quot;highlighter-rouge&quot;&gt;roles&lt;/code&gt;.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;|-- ansible | |-- init | | |-- tasks | | | |-- main.yml | |-- playbook.yml |-- Vagrantfil &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;create &lt;code class=&quot;highlighter-rouge&quot;&gt;init/tasks/main.yml&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;ansible&lt;/code&gt; folder and modify it like below.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Make app directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;path=/var/www state=directory mode=0755&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Symbolic link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;src=/vagrant dest=/var/www/vhosts state=link&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Set timezone to Asia/Tokyo&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;timezone&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Asia/Tokyo&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Update and upgrade apt packages&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apt&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;upgrade&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;yes&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;update_cache&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;yes&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;cache_valid_time&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;86400&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Add python3.6 repo&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apt_repository&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;ppa:jonathonf/python-3.6'&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install basic packages&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apt&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;pkg&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;unzip&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python3.6&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python-pip&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python3-pip&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;fabric&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;present&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;update_cache&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;yes&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;let’s see Ansible commands one by one.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Make app directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;path=/var/www state=directory mode=0755&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;above is one of Ansible commands. &lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt; 위에 내용은 앤서블(Ansible)의 명령어를 나타냅니다. &lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt; is the value to distinguish the current command. this command creates the folder by Ansible &lt;code class=&quot;highlighter-rouge&quot;&gt;file&lt;/code&gt; command.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Symbolic link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;src=/vagrant dest=/var/www/vhosts state=link&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;link &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant&lt;/code&gt; folder to &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www/vhosts&lt;/code&gt; folder for management.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Set timezone to America/New_York&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;timezone&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;America/New_York&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;set local server timezone.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Update and upgrade apt packages&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apt&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;upgrade&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;yes&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;update_cache&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;yes&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;cache_valid_time&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;86400&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;packages&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;update linux package management tool(&lt;code class=&quot;highlighter-rouge&quot;&gt;apt-get&lt;/code&gt;). &lt;code class=&quot;highlighter-rouge&quot;&gt;become: true&lt;/code&gt; executes Ansible command by root permission.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Add python3.6 repo&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apt_repository&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;ppa:jonathonf/python-3.6'&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;Ansible has some modules depend on python so we need to install python. add python repository for installing.&lt;/p&gt; &lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install basic packages&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apt&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;pkg&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;unzip&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python3.6&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python-pip&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python3-pip&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;fabric&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;present&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;update_cache&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;yes&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;install git, unzip programs and python programs for later.&lt;/p&gt; &lt;h2 id=&quot;modify-vagrantfile&quot;&gt;modify Vagrantfile&lt;/h2&gt; &lt;p&gt;add below to &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt;&lt;/p&gt; &lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# -*- mode: ruby -*-&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# vi: set ft=ruby :&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;provision&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;shell&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;inline: &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;SHELL&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt; ... sudo ansible-playbook /vagrant/ansible/playbook.yml &lt;/span&gt;&lt;span class=&quot;no&quot;&gt; SHELL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;synced_folder&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/vagrant&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;we added &lt;code class=&quot;highlighter-rouge&quot;&gt;ansible-playbook /vagrant/ansible/playbook.yml&lt;/code&gt; in provision shell which we’ve introduced previous blog. if we execute &lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant up&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant provision&lt;/code&gt;, Ansible Playbook we created is automatically executed.&lt;/p&gt; &lt;p&gt;and we added &lt;code class=&quot;highlighter-rouge&quot;&gt;config.vm.synced_folder &quot;.&quot;, &quot;/vagrant&quot;&lt;/code&gt; command to sync local machine(host system) folder to virtual machine(guest system) &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant&lt;/code&gt; folder. now if we edit files in local machine(host system) folder, automatically upload and sync to virtual machine(guest system).&lt;/p&gt; &lt;h2 id=&quot;test&quot;&gt;test&lt;/h2&gt; &lt;p&gt;let’s test to configure the server automatically by Ansible Playbook and Vagrantfile. if old virtual machine(guest system) is executing, execute below vagrant command to destroy virtual machine(guest system).&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant destroy &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;execute below vagrant command to create virtual machine(guest system). we can see difference between before and now. we can see Ansible Playbook is executed in console.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant up &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;after virtual machine(guest system) is created, execute below vagrant command to access to virtual machine(guest system).&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant ssh &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;execute below commands to check Vagrantfile and Ansible Playbook have worked well.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /vagrant &lt;span class=&quot;nb&quot;&gt;ls &lt;/span&gt;git &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt; unzip &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;completed&quot;&gt;completed&lt;/h2&gt; &lt;p&gt;in this blog post, we installed programs basically required by Ansible Playbook to virtual machine(guest system). we looked briefly Ansible Playbook through this blog. also we modified &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; to execute Ansible Playbook automatically when virtual machine(guest system) is started and sync the folder that Vagrantfile was executed to &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant&lt;/code&gt; folder in virtual machine(guest system).&lt;/p&gt; &lt;p&gt;we should use Ansible Playbook better than here, we feel shameful because of simple usage. we added Ansible Document site in the bottom. please see that and use Ansible more beautifully.&lt;/p&gt; &lt;p&gt;next we will see how to use docker in virtual machine(guest system).&lt;/p&gt; &lt;h2 id=&quot;reference&quot;&gt;reference&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;Ansible Document: &lt;a href=&quot;https://docs.ansible.com/&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://docs.ansible.com/&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;</content><author><name>dev.yakuza@gmail.com</name></author><summary type="html">outline we try to use Ansilbe Playbook to configure the server. basically, we will use Ansible Playbook to install server programs we need and configure some settings. in this blog, we will make virtual machine(guest system) by vagrant and install Ansible in there.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://dev-yakuza.github.io/assets/images/category/environment/ansible-playbook.jpg"/></entry><entry xml:lang="en"><title type="html">Firebase Analytics</title><link href="https://dev-yakuza.github.io/en/react-native/react-native-firebase-analytics/" rel="alternate" type="text/html" title="Firebase Analytics"/><published>2018-11-26T00:00:00+09:00</published><updated>2018-11-29T17:47:41+09:00</updated><id>https://dev-yakuza.github.io/react-native/firebase-analytics-en</id><content type="html" xml:base="https://dev-yakuza.github.io/react-native/react-native-firebase-analytics/">&lt;h2 id=&quot;outline&quot;&gt;outline&lt;/h2&gt; &lt;p&gt;we introduced how to set &lt;code class=&quot;highlighter-rouge&quot;&gt;react-native-firebase&lt;/code&gt; at previous blog post - &lt;a href=&quot;https://dev-yakuza.github.io/react-native/react-native-firebase-admob/&quot; target=&quot;_blank&quot;&gt;Firebase Admob&lt;/a&gt;. we mentioned at previous blog post that Firebase Analytics automatically is started by configuring &lt;code class=&quot;highlighter-rouge&quot;&gt;react-native-firebase&lt;/code&gt;. however, when we saw results created Firebase Analytics automatically, we felt that’s not enough, so we write this blog post.&lt;/p&gt; &lt;p&gt;in here we will introduce how to make Firebase Analytics results more detail by using &lt;code class=&quot;highlighter-rouge&quot;&gt;react-native-firebase&lt;/code&gt;.&lt;/p&gt; &lt;h2 id=&quot;configure-library&quot;&gt;configure library&lt;/h2&gt; &lt;p&gt;this blog post is for how to use &lt;code class=&quot;highlighter-rouge&quot;&gt;react-native-firebase&lt;/code&gt; for Firebase Analytics. so we need to set &lt;code class=&quot;highlighter-rouge&quot;&gt;react-native-firebase&lt;/code&gt; basically. if you don’t know how to set &lt;code class=&quot;highlighter-rouge&quot;&gt;react-native-firebase&lt;/code&gt;, see our preivous blog post - &lt;a href=&quot;https://dev-yakuza.github.io/react-native/react-native-firebase-admob/&quot; target=&quot;_blank&quot;&gt;Firebase Admob&lt;/a&gt;. in this blog post, we skip to install and configure &lt;code class=&quot;highlighter-rouge&quot;&gt;react-native-firebase&lt;/code&gt;.&lt;/p&gt; &lt;h2 id=&quot;debugview&quot;&gt;DebugView&lt;/h2&gt; &lt;p&gt;Firebase Analytics gathers app event logs for about one hour and upload them. so if we want to see analytics result data, we should wait for about one hour. however, we can’t wait for one hour to develop or test. so Firebase Analytics provides &lt;code class=&quot;highlighter-rouge&quot;&gt;DebugView&lt;/code&gt; which we can debug analytics events. if we use DebugView, we can see almost real time analytics results.&lt;/p&gt; &lt;p&gt;first, we configure DebugView so that we can immediately see Firebase Analytics results after adding &lt;code class=&quot;highlighter-rouge&quot;&gt;react-native-firebase&lt;/code&gt; library features.&lt;/p&gt; &lt;h3 id=&quot;ios&quot;&gt;iOS&lt;/h3&gt; &lt;p&gt;configure below to iOS for using Firebase Analytics DebugView feature.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;click &lt;code class=&quot;highlighter-rouge&quot;&gt;ios/[project].xcworkspace&lt;/code&gt; file in RN(react native) project folder to execute xcode&lt;/li&gt; &lt;li&gt;select &lt;code class=&quot;highlighter-rouge&quot;&gt;Product&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Scheme&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Edit Scheme...&lt;/code&gt; menu on the top of the screen. &lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/edit-scheme.png&quot; alt=&quot;xcode edit scheme&quot; /&gt;&lt;/li&gt; &lt;li&gt;select &lt;code class=&quot;highlighter-rouge&quot;&gt;Run&lt;/code&gt; menu on the left of &lt;code class=&quot;highlighter-rouge&quot;&gt;Edit scheme...&lt;/code&gt; dialog and click &lt;code class=&quot;highlighter-rouge&quot;&gt;Arguments&lt;/code&gt; tab on right side. &lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/edit-scheme-arguments.png&quot; alt=&quot;edit scheme arguments&quot; /&gt;&lt;/li&gt; &lt;li&gt;click &lt;code class=&quot;highlighter-rouge&quot;&gt;+&lt;/code&gt; button in &lt;code class=&quot;highlighter-rouge&quot;&gt;Arguments Passed On Launch&lt;/code&gt; session on &lt;code class=&quot;highlighter-rouge&quot;&gt;Arguments&lt;/code&gt; tab and insert below code(include &lt;code class=&quot;highlighter-rouge&quot;&gt;-&lt;/code&gt; ) &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nt&quot;&gt;-FIRDebugEnabled&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt; &lt;/div&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/edit-scheme-FIRDebugEnabled.png&quot; alt=&quot;edit scheme arguments FIRDebugEnabled&quot; /&gt;&lt;/p&gt; &lt;/li&gt; &lt;/ul&gt; &lt;h3 id=&quot;android&quot;&gt;Android&lt;/h3&gt; &lt;p&gt;Android is more simple than iOS. execute Android Emulator or Device and execute below code.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;adb shell setprop debug.firebase.analytics.app &amp;lt;package_name&amp;gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;if you want to stop &lt;code class=&quot;highlighter-rouge&quot;&gt;DebugView&lt;/code&gt; of Firebase Analytics, execute below code.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;adb shell setprop debug.firebase.analytics.app .none. &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h3 id=&quot;test&quot;&gt;test&lt;/h3&gt; &lt;p&gt;go to &lt;code class=&quot;highlighter-rouge&quot;&gt;DebugView&lt;/code&gt; menu in Firebase Analytics on Firebase Console.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/firebase-analytics-debugview.png&quot; alt=&quot;firebase analytics debugview&quot; /&gt;&lt;/p&gt; &lt;p&gt;we didn’t execute any iOS, Android so &lt;code class=&quot;highlighter-rouge&quot;&gt;DebugView&lt;/code&gt; is wait status. now, execute iOS or Android.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/debugview-analytics.png&quot; alt=&quot;firebase analytics debugview analytics&quot; /&gt;&lt;/p&gt; &lt;p&gt;after a while, you can see almost real time analytics results.&lt;/p&gt; &lt;h2 id=&quot;analyze-screens&quot;&gt;analyze screens&lt;/h2&gt; &lt;p&gt;Firebase Analytics has &lt;code class=&quot;highlighter-rouge&quot;&gt;screen_view&lt;/code&gt; Event to analyze what screens users saw.&lt;/p&gt; &lt;p&gt;click &lt;code class=&quot;highlighter-rouge&quot;&gt;Events&lt;/code&gt; menu in &lt;code class=&quot;highlighter-rouge&quot;&gt;Analytics&lt;/code&gt; on Firebase Console. you can see below screen.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/analytics-events.png&quot; alt=&quot;google firebase console Analytics Events menu&quot; /&gt;&lt;/p&gt; &lt;p&gt;select &lt;code class=&quot;highlighter-rouge&quot;&gt;screen_view&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;Event&lt;/code&gt; list.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/analytics-events-screen_view.png&quot; alt=&quot;Firebase Analytics Events screen_view&quot; /&gt;&lt;/p&gt; &lt;p&gt;scroll down a little bit, you can see &lt;code class=&quot;highlighter-rouge&quot;&gt;User engagement&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Screen class&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/screen_view-class-to-name.png&quot; alt=&quot;Firebase Analytics Events screen_view screen class to screen name&quot; /&gt;&lt;/p&gt; &lt;p&gt;change &lt;code class=&quot;highlighter-rouge&quot;&gt;Screen class&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;Screen name&lt;/code&gt; in User engagement.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/screen_name-no-data.png&quot; alt=&quot;Firebase Analytics Events screen name no data&quot; /&gt;&lt;/p&gt; &lt;p&gt;if you check up to here, you might feel it’s not enough. we can see only basic class in &lt;code class=&quot;highlighter-rouge&quot;&gt;Screen class&lt;/code&gt; and there are no data in &lt;code class=&quot;highlighter-rouge&quot;&gt;Screen name&lt;/code&gt;, so we can’t analyze which screens users have seen more.&lt;/p&gt; &lt;p&gt;so we decided to use &lt;code class=&quot;highlighter-rouge&quot;&gt;setCurrentScreen&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;react-native-firebase&lt;/code&gt; feature to analyze screens users have seen.&lt;/p&gt; &lt;p&gt;add below code to screens you want to analyze.&lt;/p&gt; &lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;firebase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;analytics&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setCurrentScreen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'HOME'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;insert App screen name to &lt;code class=&quot;highlighter-rouge&quot;&gt;setCurrentScreen&lt;/code&gt; of react-native-firebase feature.&lt;/p&gt; &lt;p&gt;and after testing, we can see App screen name which we inserted to &lt;code class=&quot;highlighter-rouge&quot;&gt;setCurrentScreen&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/screen_name-with-data.png&quot; alt=&quot;Firebase Analytics Events screen name with data&quot; /&gt;&lt;/p&gt; &lt;p&gt;you can see real time analytics results in &lt;code class=&quot;highlighter-rouge&quot;&gt;DebugView&lt;/code&gt; on Firebase Analytics.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/screen_name-on-debugview.png&quot; alt=&quot;Firebase Analytics Events screen name on debug view&quot; /&gt;&lt;/p&gt; &lt;p&gt;DebugView에서 해당 이벤트(screen_view)를 선택하면 위와 같이 상세 화면을 볼 수 있습니다.&lt;/p&gt; &lt;h2 id=&quot;analyze-custom-event&quot;&gt;analyze Custom Event&lt;/h2&gt; &lt;p&gt;we could analyze which screen users have seen more by using &lt;code class=&quot;highlighter-rouge&quot;&gt;setCurrentScreen&lt;/code&gt; but we don’t still know what actions users have done in screens. so let’s see how to use &lt;code class=&quot;highlighter-rouge&quot;&gt;logEvent&lt;/code&gt; to add Custom Event in Firebase Analytics.&lt;/p&gt; &lt;p&gt;we added below code to analyze Custom Event in Firebase Analytics.&lt;/p&gt; &lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_onSpeech&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Tts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;firebase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;analytics&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;logEvent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'onPressSoundButton'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;logEvent first parameter only supports 100 english character and underbar(_).(&lt;code class=&quot;highlighter-rouge&quot;&gt;up to 100 characters is the maximum character length supported for event parameters.&lt;/code&gt;) but our app is multi-language app and we want to know which actions in which languages. so we use second parameter for adding Custom Parameter to Custom Event. second parameter is Object type so we can make any parameters we want.&lt;/p&gt; &lt;p&gt;if you set Custom Parameter to Custom Event like above, you need to add to Firebase Console too.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/custom-event-custom-parameter.png&quot; alt=&quot;Firebase Analytics Events custom event&quot; /&gt;&lt;/p&gt; &lt;p&gt;go to &lt;code class=&quot;highlighter-rouge&quot;&gt;Analytics&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Events&lt;/code&gt; menu, mousehover to Custom Event you added in Event list.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/custom-parameter-menu.png&quot; alt=&quot;Firebase Analytics custom parameter menu&quot; /&gt;&lt;/p&gt; &lt;p&gt;if you mousehover, you can see &lt;code class=&quot;highlighter-rouge&quot;&gt;...&lt;/code&gt; button. click it and select &lt;code class=&quot;highlighter-rouge&quot;&gt;Edit parameter reporting&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/custom-parameter-edit-parameter-reporting.png&quot; alt=&quot;Firebase Analytics custom parameter edit parameter reporting&quot; /&gt;&lt;/p&gt; &lt;p&gt;insert Custom Parameter of Custom Event to searchbar on the left side and click &lt;code class=&quot;highlighter-rouge&quot;&gt;ADD&lt;/code&gt; button to add Custom parameter.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/add-custom-parameter.png&quot; alt=&quot;Firebase Analytics add custom parameter&quot; /&gt;&lt;/p&gt; &lt;p&gt;do test after adding. after some data are accumulating(almost one day), select Custom Event you added in &lt;code class=&quot;highlighter-rouge&quot;&gt;Events&lt;/code&gt; menu.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/custom-parameter.png&quot; alt=&quot;Firebase Analytics custom parameter&quot; /&gt;&lt;/p&gt; &lt;p&gt;scroll down a little bit, you can see Custom Parameter analytics data you added.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/custom-parameter-result.png&quot; alt=&quot;Firebase Analytics custom parameter result&quot; /&gt;&lt;/p&gt; &lt;p&gt;of course, you can see almost real time analytics results in Firebase Analytics &lt;code class=&quot;highlighter-rouge&quot;&gt;DebugView&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/react-native/react-native-firebase-analytics/custom_event-on-debugview.png&quot; alt=&quot;Firebase Analytics Events custom event on debug view&quot; /&gt;&lt;/p&gt; &lt;p&gt;if you select Custom Event in DebugView, you can see details with Custom Parameter.&lt;/p&gt; &lt;h2 id=&quot;reference&quot;&gt;reference&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;firebase debugging event: &lt;a href=&quot;https://firebase.google.com/docs/analytics/debugview&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://firebase.google.com/docs/analytics/debugview&lt;/a&gt;&lt;/li&gt; &lt;li&gt;react-native-firebase: &lt;a href=&quot;https://rnfirebase.io/docs/v5.x.x/analytics/reference/analytics&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://rnfirebase.io/docs/v5.x.x/analytics/reference/analytics&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;</content><author><name>dev.yakuza@gmail.com</name></author><summary type="html">outline we introduced how to set react-native-firebase at previous blog post - Firebase Admob. we mentioned at previous blog post that Firebase Analytics automatically is started by configuring react-native-firebase. however, when we saw results created Firebase Analytics automatically, we felt that’s not enough, so we write this blog post.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://dev-yakuza.github.io/assets/images/category/react-native/react-native-firebase-analytics.jpg"/></entry><entry xml:lang="en"><title type="html">Ansible installation</title><link href="https://dev-yakuza.github.io/en/environment/install-ansible/" rel="alternate" type="text/html" title="Ansible installation"/><published>2018-11-26T00:00:00+09:00</published><updated>2018-12-04T09:37:44+09:00</updated><id>https://dev-yakuza.github.io/environment/install_ansible-en</id><content type="html" xml:base="https://dev-yakuza.github.io/environment/install-ansible/">&lt;h2 id=&quot;outline&quot;&gt;outline&lt;/h2&gt; &lt;p&gt;if we try to explain Ansible, we need to make a book for it. however we don’t know Ansible perfectly and our level is not able to explain it. so we can’t introduce details about Ansible but we try to explain Ansible by how we use Ansible. simply Ansible is an automation tool for infrastructure. we can do automatically install or deploy by Ansible. in here we introduce how to install Ansible to vagrant.&lt;/p&gt; &lt;p&gt;this blog post is for people who installed virtualbox and vagrant. if you don’t install virtualbox and vagrant, see our previous blog - &lt;a href=&quot;https://dev-yakuza.github.io/environment/vagrant-install-and-usage/&quot; target=&quot;_blank&quot;&gt;vagrant installation and usage&lt;/a&gt;&lt;/p&gt; &lt;h2 id=&quot;create-virtual-machine-setting&quot;&gt;create virtual machine setting&lt;/h2&gt; &lt;p&gt;execute below vagrant command to create virtual machine(guest system) setting.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant init bento/ubuntu-16.04 &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;after executing above vagrant command, you can see &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; file in the folder you executed it. below code is &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; contents without comment out(&lt;code class=&quot;highlighter-rouge&quot;&gt;#&lt;/code&gt;).&lt;/p&gt; &lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# -*- mode: ruby -*-&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# vi: set ft=ruby :&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;box&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bento/ubuntu-16.04&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;create-and-check-virtual-machine&quot;&gt;create and check virtual machine&lt;/h2&gt; &lt;p&gt;execute below vagrant command to create virtual machine(guest syste).&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant up &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;execute below vagrant command to access virtual machine(guest system) after being created it.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant ssh &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;configure-ansible-installation&quot;&gt;configure Ansible installation&lt;/h2&gt; &lt;p&gt;if you execute below command in virtual machine(guest system), you can know Ansible is not installed yet.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ansible &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;open and modify &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; like below.&lt;/p&gt; &lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# -*- mode: ruby -*-&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# vi: set ft=ruby :&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;box&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bento/ubuntu-16.04&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;provision&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;shell&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;inline: &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;SHELL&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt; sudo apt-get update sudo apt-get install software-properties-common sudo apt-add-repository --yes --update ppa:ansible/ansible sudo apt-get install ansible --yes &lt;/span&gt;&lt;span class=&quot;no&quot;&gt; SHELL&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;provision shell makes to upload and execute script in virtual machine(guest system). add Ansible installation script to vagrant provision shell.&lt;/p&gt; &lt;h2 id=&quot;install-ansible&quot;&gt;install Ansible&lt;/h2&gt; &lt;p&gt;execute below vagrant command in local machine(host systme).&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant provision &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;access virtual machine(guest system) again and check Ansible installed.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant ssh ansible &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;if Ansible is installed, you can see Ansible version like below.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ansible 2.7.2 config file &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; /etc/ansible/ansible.cfg configured module search path &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;u&lt;span class=&quot;s1&quot;&gt;'/home/vagrant/.ansible/plugins/modules'&lt;/span&gt;, u&lt;span class=&quot;s1&quot;&gt;'/usr/share/ansible/plugins/modules'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; ansible python module location &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; /usr/lib/python2.7/dist-packages/ansible executable location &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; /usr/bin/ansible python version &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2.7.12 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default, Dec 4 2017, 14:50:18&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;GCC 5.4.0 20160609] &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;above process is we created virtual machine(guest system) without Ansible installation script in provision shell and added Ansible installation script to provision shell and executed vagrant command(&lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant provision&lt;/code&gt;) to install Ansible.&lt;/p&gt; &lt;p&gt;however, if you configure environment to other PC or reconfigure, you just need to execute &lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant up&lt;/code&gt; because your &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; already has Ansible installation script in provision shell.&lt;/p&gt; &lt;p&gt;execute below vagrant command to remove virtual machine(guest system) for test it.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant destroy &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;execute below vagrant command to create virtual machine(guest system) again.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant up &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;after creating, execute below vagrant command to access virtual machine(guest system).&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant ssh &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;execute below command to check Ansible is installed.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ansible &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;if Ansible is installed, you can see below on the screen.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ansible 2.7.2 config file &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; /etc/ansible/ansible.cfg configured module search path &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;u&lt;span class=&quot;s1&quot;&gt;'/home/vagrant/.ansible/plugins/modules'&lt;/span&gt;, u&lt;span class=&quot;s1&quot;&gt;'/usr/share/ansible/plugins/modules'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; ansible python module location &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; /usr/lib/python2.7/dist-packages/ansible executable location &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; /usr/bin/ansible python version &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2.7.12 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default, Dec 4 2017, 14:50:18&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;GCC 5.4.0 20160609] &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;completed&quot;&gt;completed&lt;/h2&gt; &lt;p&gt;in here, we introduced how to install Ansible to vagrant by Vagrantfile. if Ansible masters saw this blog, maybe they say why do we need to install Ansible to vagrant? not local PC(host system)? normally people install Ansible to local machine(host system) and they use Ansible to configure the infrastructure for virtual machine(guest system) but windows OS doesn’t support Ansible yet so we decided to do above process. next blog, we will introduce how to use Ansible to configure development environment in virtual machine(guest system).&lt;/p&gt;</content><author><name>dev.yakuza@gmail.com</name></author><summary type="html">outline if we try to explain Ansible, we need to make a book for it. however we don’t know Ansible perfectly and our level is not able to explain it. so we can’t introduce details about Ansible but we try to explain Ansible by how we use Ansible. simply Ansible is an automation tool for infrastructure. we can do automatically install or deploy by Ansible. in here we introduce how to install Ansible to vagrant.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://dev-yakuza.github.io/assets/images/category/environment/install-ansible.jpg"/></entry><entry xml:lang="en"><title type="html">vagrant installation and usage</title><link href="https://dev-yakuza.github.io/en/environment/vagrant-install-and-usage/" rel="alternate" type="text/html" title="vagrant installation and usage"/><published>2018-11-25T00:00:00+09:00</published><updated>2018-11-26T18:26:00+09:00</updated><id>https://dev-yakuza.github.io/environment/vagrant_install_and_usage-en</id><content type="html" xml:base="https://dev-yakuza.github.io/environment/vagrant-install-and-usage/">&lt;h2 id=&quot;outline&quot;&gt;outline&lt;/h2&gt; &lt;p&gt;we want to create backend - server development environment same like server. so in here, we will introduce how to use vagrant to make virtual machine.&lt;/p&gt; &lt;h2 id=&quot;install-virtualbox&quot;&gt;install virtualbox&lt;/h2&gt; &lt;p&gt;vagrant is virtual machine management tool. in other words, vagrant is a tool to create and manage virtual machine on virtual environment. so to manage virtual environment is not vagrant feature. there are many tools to create and manage virtual environment but we will use virtualbox in here.&lt;/p&gt; &lt;p&gt;click below link to go to virtualbox download site.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;virtualbox: &lt;a href=&quot;https://www.virtualbox.org/wiki/Downloads&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://www.virtualbox.org/wiki/Downloads&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;when you see below screen, download and install virtualbox to your PC.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/environment/vagrant-install-and-usage/virtualbox_download.png&quot; alt=&quot;virtualbox donwload page&quot; /&gt;&lt;/p&gt; &lt;p&gt;to download and install virtualbox is same to download and install normal software so we will skip to talk about downloading and installing.&lt;/p&gt; &lt;p&gt;after installation, you can see below screen since you execute virtualbox.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/environment/vagrant-install-and-usage/virtualbox_installed.png&quot; alt=&quot;virtualbox installed&quot; /&gt;&lt;/p&gt; &lt;h2 id=&quot;install-vagrant&quot;&gt;install vagrant&lt;/h2&gt; &lt;p&gt;now we can make virtual environment by virtualbox. let’s see how to install vagrant which is helpful to create virtual machine on virtual environment.&lt;/p&gt; &lt;p&gt;click below link to go to vagrant download site.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;vagrant: &lt;a href=&quot;https://www.vagrantup.com/downloads.html&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://www.vagrantup.com/downloads.html&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;after clicking above link to go to vagrant download site, you can see below screen.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/environment/vagrant-install-and-usage/vagrant_site.png&quot; alt=&quot;vagrant download site&quot; /&gt;&lt;/p&gt; &lt;p&gt;select your PC OS installer and download it. we also skip how to download and install vagrant because it’s same to download and install normal software.&lt;/p&gt; &lt;p&gt;after installing, execute below command to check vagrant is installed.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;if vagrant is installed, you can see vagrant version like below.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Vagrant 2.2.1 &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;add-box&quot;&gt;add box&lt;/h2&gt; &lt;p&gt;add box that vagrant will use to make virtual machine. box is a package include OS of virtual machine and softwares in OS. below links are official basic box and vagrant user box site.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;official box site: &lt;a href=&quot;https://app.vagrantup.com/boxes/search&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://app.vagrantup.com/boxes/search&lt;/a&gt;&lt;/li&gt; &lt;li&gt;user box site: &lt;a href=&quot;http://www.vagrantbox.es/&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;http://www.vagrantbox.es/&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;execute below vagrant command to add box to your pc.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;add official box&lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant box add centos/7 &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;ul&gt; &lt;li&gt;add user box&lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant box add centos66 https://github.com/tommy-muehle/puppet-vagrant-boxes/releases/download/1.0.0/centos-6.6-x86_64.box &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;we will use official box that is &lt;code class=&quot;highlighter-rouge&quot;&gt;bento/ubuntu-16.04&lt;/code&gt;.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;official &lt;code class=&quot;highlighter-rouge&quot;&gt;bento/ubuntu-16.04&lt;/code&gt;:&lt;a href=&quot;https://app.vagrantup.com/bento/boxes/ubuntu-16.04&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://app.vagrantup.com/bento/boxes/ubuntu-16.04&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;execute below vagrant command to add &lt;code class=&quot;highlighter-rouge&quot;&gt;bento/ubuntu-16.04&lt;/code&gt; box to your PC.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant box add bento/ubuntu-16.04 &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;execute below vagrant command to check added box list.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant box list &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;if you add wrong box, it’s possible to delete it by executing below vagrant command.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant box remove bento/ubuntu-16.04 &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;create-virtual-machine-setting&quot;&gt;create virtual machine setting&lt;/h2&gt; &lt;p&gt;execute below vagrant command to create virtual machine setting using vagrant and added box.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# mkdir create your project folder&lt;/span&gt; mkdir temp &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;temp vagrant init bento/ubuntu-16.04 &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;you can see &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; in the folder you executed command(temp). below code is contents of &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt;file that we removed comment out(&lt;code class=&quot;highlighter-rouge&quot;&gt;#&lt;/code&gt;).&lt;/p&gt; &lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# -*- mode: ruby -*-&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# vi: set ft=ruby :&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;box&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bento/ubuntu-16.04&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;create-virtual-machine&quot;&gt;create virtual machine&lt;/h2&gt; &lt;p&gt;execute below vagrant command to create virtual machine with &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; we made above.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant up &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;execute &lt;code class=&quot;highlighter-rouge&quot;&gt;virtualbox&lt;/code&gt; we downloaded and installed, we can see one virtual machine.&lt;/p&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/category/environment/vagrant-install-and-usage/virtualbox-with-machine.png&quot; alt=&quot;virtualbox with virtual machine&quot; /&gt;&lt;/p&gt; &lt;p&gt;execute below vagrant command to access vitual machine.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant ssh &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;execute below command to come back from virtual machine to local PC.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;stop-virtual-machine&quot;&gt;stop virtual machine&lt;/h2&gt; &lt;p&gt;if you want to stop virtual machine, execute below vagrant command.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant halt &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;delete-virtual-machine&quot;&gt;delete virtual machine&lt;/h2&gt; &lt;p&gt;if virtual machine is not needed anymore, execute below vagrant command to delete it.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant destroy &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;completed&quot;&gt;completed&lt;/h2&gt; &lt;p&gt;we saw how to make virtual machine by vagrant. in next blog posts, we will introduce how to configure development environment by editing &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; file and how to set development environment in virtual machine.&lt;/p&gt;</content><author><name>dev.yakuza@gmail.com</name></author><summary type="html">outline we want to create backend - server development environment same like server. so in here, we will introduce how to use vagrant to make virtual machine.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://dev-yakuza.github.io/assets/images/category/environment/vagrant-install-and-usage.jpg"/></entry><entry xml:lang="en"><title type="html">change simulator on iOS</title><link href="https://dev-yakuza.github.io/en/react-native/ios-change-simulator/" rel="alternate" type="text/html" title="change simulator on iOS"/><published>2018-11-23T00:00:00+09:00</published><updated>2018-11-24T09:08:46+09:00</updated><id>https://dev-yakuza.github.io/react-native/ios-change-simulator-en</id><content type="html" xml:base="https://dev-yakuza.github.io/react-native/ios-change-simulator/">&lt;h2 id=&quot;outline&quot;&gt;outline&lt;/h2&gt; &lt;p&gt;we always use below command on RN(react native) development.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;react-native run-ios &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;it’s not problem when we develop but when we want to test RN(react native) project on different device, it always uncomfortable. so we introduce how to change simulator by command line.&lt;/p&gt; &lt;h2 id=&quot;check-ios-simulators&quot;&gt;check iOS simulators&lt;/h2&gt; &lt;p&gt;check current iOS simulator we can use.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;xcrun simctl list devices &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;change-simulator&quot;&gt;change simulator&lt;/h2&gt; &lt;p&gt;execute below command to start the simulator you want to you.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone 5s&quot;&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;below command list is examples of how to change the simulator.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone 5s&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone 6&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone 6 Plus&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone 6s&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone 6s Plus&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone 7&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone 7 Plus&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone 8&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone 8 Plus&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone SE&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone X&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone XR&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone XS&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhone XS Max&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPad Air&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPad Air 2&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPad&quot;&lt;/span&gt; react-native run-ios &lt;span class=&quot;nt&quot;&gt;--simulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPad Pro&quot;&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>dev.yakuza@gmail.com</name></author><summary type="html">outline we always use below command on RN(react native) development.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://dev-yakuza.github.io/assets/images/category/react-native/ios-change-simulator.jpg"/></entry><entry xml:lang="en"><title type="html">Android build and test</title><link href="https://dev-yakuza.github.io/en/react-native/android-running-on-device/" rel="alternate" type="text/html" title="Android build and test"/><published>2018-11-21T00:00:00+09:00</published><updated>2018-11-24T09:08:46+09:00</updated><id>https://dev-yakuza.github.io/react-native/android-running-on-device-en</id><content type="html" xml:base="https://dev-yakuza.github.io/react-native/android-running-on-device/">&lt;h2 id=&quot;outline&quot;&gt;outline&lt;/h2&gt; &lt;p&gt;we will introduce how to build and test RN(react native) project we’ve developed on Android device. in this blog, we will use Mac to create Android Signing Key and build. we refer RN(react native) official site so if you want to know details, see official site.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;official site: &lt;a href=&quot;https://facebook.github.io/react-native/docs/signed-apk-android&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://facebook.github.io/react-native/docs/signed-apk-android&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;h2 id=&quot;create-android-signing-key&quot;&gt;create Android Signing Key&lt;/h2&gt; &lt;p&gt;open &lt;code class=&quot;highlighter-rouge&quot;&gt;terminal&lt;/code&gt; program on Mac and go to &lt;code class=&quot;highlighter-rouge&quot;&gt;android/app&lt;/code&gt; in RN(react native) project.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;your path]/android/app &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;execute below command to issue Android Signing Key.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# keytool -genkey -v -keystore my-release-key.keystore -alias my-key-alias -keyalg RSA -keysize 2048 -validity 10000&lt;/span&gt; keytool &lt;span class=&quot;nt&quot;&gt;-genkey&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-keystore&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key-name].keystore &lt;span class=&quot;nt&quot;&gt;-alias&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key &lt;span class=&quot;nb&quot;&gt;alias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-keyalg&lt;/span&gt; RSA &lt;span class=&quot;nt&quot;&gt;-keysize&lt;/span&gt; 2048 &lt;span class=&quot;nt&quot;&gt;-validity&lt;/span&gt; 10000 Enter keystore password: Re-enter new password: What is your first and last name? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Unknown]: What is the name of your organizational unit? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Unknown]: What is the name of your organization? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Unknown]: What is the name of your City or Locality? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Unknown]: What is the name of your State or Province? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Unknown]: What is the two-letter country code &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;this unit? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Unknown]: Is &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*****&lt;/span&gt;, &lt;span class=&quot;nv&quot;&gt;OU&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Unknown, &lt;span class=&quot;nv&quot;&gt;O&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Unknown, &lt;span class=&quot;nv&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*****&lt;/span&gt;, &lt;span class=&quot;nv&quot;&gt;ST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*****&lt;/span&gt;, &lt;span class=&quot;nv&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*****&lt;/span&gt; correct? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;no]: Enter key password &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &amp;lt;my-key-alias&amp;gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RETURN &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;same as keystore password&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;after inserting all, you can see &lt;code class=&quot;highlighter-rouge&quot;&gt;my-release-key.keystore&lt;/code&gt; file in &lt;code class=&quot;highlighter-rouge&quot;&gt;android/app&lt;/code&gt;&lt;/p&gt; &lt;h2 id=&quot;configure-signing-key&quot;&gt;configure Signing Key&lt;/h2&gt; &lt;p&gt;after creating Signing Key, we need to configure it to &lt;code class=&quot;highlighter-rouge&quot;&gt;gradle&lt;/code&gt;. open &lt;code class=&quot;highlighter-rouge&quot;&gt;android/gradle.properties&lt;/code&gt; file and add blow code.&lt;/p&gt; &lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;MYAPP_RELEASE_STORE_FILE=my-release-key.keystore MYAPP_RELEASE_KEY_ALIAS=my-key-alias MYAPP_RELEASE_STORE_PASSWORD=***** MYAPP_RELEASE_KEY_PASSWORD=***** &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;add below code to &lt;code class=&quot;highlighter-rouge&quot;&gt;android/app/build.gradle&lt;/code&gt; file.&lt;/p&gt; &lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;... android { ... defaultConfig { ... } signingConfigs { release { if (project.hasProperty('MYAPP_RELEASE_STORE_FILE')) { storeFile file(MYAPP_RELEASE_STORE_FILE) storePassword MYAPP_RELEASE_STORE_PASSWORD keyAlias MYAPP_RELEASE_KEY_ALIAS keyPassword MYAPP_RELEASE_KEY_PASSWORD } } } buildTypes { release { ... signingConfig signingConfigs.release } } } ... &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;build&quot;&gt;build&lt;/h2&gt; &lt;p&gt;go to &lt;code class=&quot;highlighter-rouge&quot;&gt;android&lt;/code&gt; folder in RN(react native) project folder and execute below code to build.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./gradlew assembleRelease &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;you can see built file on below path.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;android/app/build/outputs/apk/release/app-release.apk &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;but we got below error at this section.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;... Execution failed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;task &lt;span class=&quot;s1&quot;&gt;':app:lintVitalRelease'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Lint found fatal errors &lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;assembling a release target. ... &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;it’s not good solution, but we add below code to &lt;code class=&quot;highlighter-rouge&quot;&gt;android/app/build.gradle&lt;/code&gt;.&lt;/p&gt; &lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;... android { ... lintOptions { checkReleaseBuilds false // Or, if you prefer, you can continue to check for errors in release builds, // but continue the build even when errors are found: abortOnError false } ... } ... &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;test-built-file&quot;&gt;test built file&lt;/h2&gt; &lt;p&gt;delete previous app on Android Device and execute below code to test built file.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;react-native run-android &lt;span class=&quot;nt&quot;&gt;--variant&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;release &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h2 id=&quot;error&quot;&gt;error&lt;/h2&gt; &lt;p&gt;we’ve done to follow official site but when we executed below code to build,&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./gradlew assembleRelease &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;and execute below code to test on device directly,&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;react-native run-android &lt;span class=&quot;nt&quot;&gt;--variant&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;release &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;we got below error.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;java.lang.RuntimeException: Unable to load script from assets &lt;span class=&quot;s1&quot;&gt;'index.android.bundle'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Make sure your bundle is packaged correctly or you&lt;span class=&quot;s1&quot;&gt;'re running a packager server. &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;as a workaround, we executed below code first to create &lt;code class=&quot;highlighter-rouge&quot;&gt;index.android.bundle&lt;/code&gt;.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;... react-native bundle &lt;span class=&quot;nt&quot;&gt;--platform&lt;/span&gt; android &lt;span class=&quot;nt&quot;&gt;--dev&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--entry-file&lt;/span&gt; index.js &lt;span class=&quot;nt&quot;&gt;--bundle-output&lt;/span&gt; android/app/src/main/assets/index.android.bundle ... &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;and build or&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./gradlew assembleRelease &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;test on device directly.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;react-native run-android &lt;span class=&quot;nt&quot;&gt;--variant&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;release &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>dev.yakuza@gmail.com</name></author><summary type="html">outline we will introduce how to build and test RN(react native) project we’ve developed on Android device. in this blog, we will use Mac to create Android Signing Key and build. we refer RN(react native) official site so if you want to know details, see official site.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://dev-yakuza.github.io/assets/images/category/react-native/android-running-on-device.jpg"/></entry><entry xml:lang="en"><title type="html">Android device test</title><link href="https://dev-yakuza.github.io/en/react-native/android-test-on-device/" rel="alternate" type="text/html" title="Android device test"/><published>2018-11-20T00:00:00+09:00</published><updated>2018-11-22T22:41:56+09:00</updated><id>https://dev-yakuza.github.io/react-native/android-test-on-device-en</id><content type="html" xml:base="https://dev-yakuza.github.io/react-native/android-test-on-device/">&lt;h2 id=&quot;outline&quot;&gt;outline&lt;/h2&gt; &lt;p&gt;it’s very stressful to develop RN(react native) on Android emulator so let’s see how to develop and test RN(react native) project on Android device. if you want to know how to develop and test RN(react native) on iOS device, see previous blog post - &lt;a href=&quot;https://dev-yakuza.github.io/react-native/ios-test-on-device/&quot; target=&quot;_blank&quot;&gt;iOS device test&lt;/a&gt;.&lt;/p&gt; &lt;h2 id=&quot;prepare&quot;&gt;prepare&lt;/h2&gt; &lt;p&gt;Obviously, We need to prepare below things to test RN(react native) project on Android device.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;Android Studio&lt;/li&gt; &lt;li&gt;Android device&lt;/li&gt; &lt;li&gt;RN(react native) project&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;if you want to knwo how to make RN(react native) development enviroment, see another blog post - &lt;a href=&quot;https://dev-yakuza.github.io/react-native/installation/&quot; target=&quot;_blank&quot;&gt;RN installation&lt;/a&gt;.&lt;/p&gt; &lt;h2 id=&quot;android-device-test&quot;&gt;Android Device test&lt;/h2&gt; &lt;p&gt;you can see all details about how to develop and test RN(react native) on Android Device in official site. we just do to follow the manual.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;official site: &lt;a href=&quot;https://facebook.github.io/react-native/docs/running-on-device&quot; rel=&quot;nofollow noreferrer&quot; target=&quot;_blank&quot;&gt;https://facebook.github.io/react-native/docs/running-on-device&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;h2 id=&quot;configure-android-device&quot;&gt;configure Android device&lt;/h2&gt; &lt;p&gt;we need to activate Developer Options in devices we use. go to &lt;code class=&quot;highlighter-rouge&quot;&gt;Settings&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;About phone&lt;/code&gt; and click &lt;code class=&quot;highlighter-rouge&quot;&gt;Build number&lt;/code&gt; several times to activate Developer Options.&lt;/p&gt; &lt;p&gt;after Developer Options is activated, we need to enable &lt;code class=&quot;highlighter-rouge&quot;&gt;USB debugging&lt;/code&gt;. click &lt;code class=&quot;highlighter-rouge&quot;&gt;Settings&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Developer Options&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;USB debugging&lt;/code&gt; and enable USB debugging.&lt;/p&gt; &lt;h2 id=&quot;connect-android-device&quot;&gt;connect Android device&lt;/h2&gt; &lt;p&gt;connect Android device to PC by USB. you can see USB debugging message on your device. approve it to make testable device.&lt;/p&gt; &lt;h2 id=&quot;execute-on-android-device&quot;&gt;execute on Android device&lt;/h2&gt; &lt;p&gt;keep connecting Android device to PC and execute Android Studio. click &lt;code class=&quot;highlighter-rouge&quot;&gt;Debug app&lt;/code&gt; button(arrow over bug icon) on the top of the screen. you can see an emulator and your device. select your device and click &lt;code class=&quot;highlighter-rouge&quot;&gt;OK&lt;/code&gt; button. finally, you can see your RN(react native) project is executed on Android device.&lt;/p&gt; &lt;p&gt;warning: this process is for testing on the device. so test server is executed on PC like doing the emulator process. and the device accesses to the server to test RN(react native) project. so the device and PC must be on same Wifi/network for testing.&lt;/p&gt; &lt;h2 id=&quot;android-version-lower-than-50&quot;&gt;Android version lower than 5.0&lt;/h2&gt; &lt;p&gt;if test Android device version is lower than 5.0, we need to set additionals. below is about how to test RN(react native) on Android device 4.4.2 we did.&lt;/p&gt; &lt;p&gt;edit &lt;code class=&quot;highlighter-rouge&quot;&gt;android/app/build.gradle&lt;/code&gt; like below in RN(react native) proejct folder.&lt;/p&gt; &lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;defaultConfig { ... ndk { // abiFilters &quot;armeabi-v7a&quot;, &quot;x86&quot; } } &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;open Android Studio and click &lt;code class=&quot;highlighter-rouge&quot;&gt;sync&lt;/code&gt; button for &lt;code class=&quot;highlighter-rouge&quot;&gt;gradle sync&lt;/code&gt;. after sync, execute RN(react native) project.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;react-native run-android &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;RN(react native) dev-server is executed and the app also is installed but red error screen is shown up.&lt;/p&gt; &lt;p&gt;shake the device to show up Developer Menu. select &lt;code class=&quot;highlighter-rouge&quot;&gt;Dev Settings&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Debug server host &amp;amp; port for device&lt;/code&gt; menu in Developer Menu. you can see the screen for inputting IP address and port. insert your PC IP and 8081 port(ex&amp;gt; 10.0.1.1:8081). go to Developer Menu again and click &lt;code class=&quot;highlighter-rouge&quot;&gt;Reload JS&lt;/code&gt; to restart project.&lt;/p&gt; &lt;h2 id=&quot;compeleted&quot;&gt;compeleted&lt;/h2&gt; &lt;p&gt;we introduced how to execute RN(react native) on Android device. now you can test your app on Android device.&lt;/p&gt;</content><author><name>dev.yakuza@gmail.com</name></author><summary type="html">outline it’s very stressful to develop RN(react native) on Android emulator so let’s see how to develop and test RN(react native) project on Android device. if you want to know how to develop and test RN(react native) on iOS device, see previous blog post - iOS device test.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://dev-yakuza.github.io/assets/images/category/react-native/android-test-on-device.jpg"/></entry></feed>